<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Optimization | IT Docs</title><link rel="canonical"/><link rel="shortcut icon" href="/it_docs/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v4.4.4"/><meta name="generator" content="Starlight v0.19.1"/><meta property="og:title" content="Optimization"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description"/><meta property="og:site_name" content="IT Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Optimization"/><meta name="twitter:description"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/it_docs/_astro/index.BsC2KTtW.css" /><script type="module" src="/it_docs/_astro/hoisted.BxjUbMOm.js"></script>
<script type="module" src="/it_docs/_astro/page.CZ0TFQCk.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/it_docs/" class="site-title sl-flex astro-m46x6ez3">  <span class="astro-m46x6ez3"> IT Docs </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/GGsmou" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Overview</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/it_docs/all/algorithms__data_structures/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Algorithms and Data Structures</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/architecture/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Architecture</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/backend/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">BackEnd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/cli/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/code_complete_2-steve_mcconnel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Notes of &quot;Code Complete 2nd edition&quot; by Steve McConnel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/code_snippets/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Code_Snippets</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/css/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CSS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/design/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Design</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/domain_driven_design-evans/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Notes of &quot;Domain Driven Design&quot; by Evans</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/fintech/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fintech</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/frontend/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FrontEnd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/general/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">General</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/it/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">IT</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/js/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">JS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/optimization/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Optimization</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/react/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">React</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/security/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Security</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/software_engineering_at_google-oreilly/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Notes of &quot;Software Engineering at Google&quot; by O&#39;Reilly</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/system_design/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">System_Design</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/testing/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Testing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/ts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TS</span>  </a> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/GGsmou" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="6" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#optimization-basics" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Optimization basics</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#web-performance" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Web-Performance</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main-metrics" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main metrics</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#rail-model" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">RAIL model</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#prpl-pattern" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">PRPL pattern</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#css-optimization" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">CSS optimization</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#lcp" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">LCP</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#caching-headers" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Caching Headers</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#pre-fetching" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Pre-Fetching</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#low-quality-image-placeholder" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Low Quality Image Placeholder</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#dev-tools" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Dev Tools</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#lighthouse" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Lighthouse</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#caching" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Caching</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#cache-types" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Cache Types</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#caching-stratagies" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Caching Stratagies</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#measuring-cache-effectiveness" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Measuring cache effectiveness</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="6"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#optimization-basics" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Optimization basics</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#web-performance" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Web-Performance</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main-metrics" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main metrics</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#rail-model" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">RAIL model</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#prpl-pattern" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">PRPL pattern</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#css-optimization" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">CSS optimization</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#lcp" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">LCP</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#caching-headers" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Caching Headers</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#pre-fetching" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Pre-Fetching</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#low-quality-image-placeholder" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Low Quality Image Placeholder</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#dev-tools" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Dev Tools</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#lighthouse" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Lighthouse</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#caching" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Caching</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#cache-types" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Cache Types</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#caching-stratagies" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Caching Stratagies</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#measuring-cache-effectiveness" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Measuring cache effectiveness</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Optimization</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <h2 id="optimization-basics">Optimization basics</h2>
<ul>
<li>over-optimization on start - bad. It is better to left product flexible and cleaner on start and add optimization if needed</li>
<li>you should optimize on start if
<ul>
<li>it is long session app</li>
<li>it is heavy computation(graphics or other computations) app</li>
<li>it is heavy app by itself</li>
</ul>
</li>
<li>to check if optimization needed
<ul>
<li>use weak device emulation chrome</li>
<li>safari browser(poorly optimized by itself)</li>
</ul>
</li>
</ul>
<h2 id="web-performance">Web-Performance</h2>
<h4 id="main-metrics">Main metrics</h4>
<ul>
<li>load time - time until page is fully loaded and interactable</li>
<li>FCP(first contentful paint) - time it takes for first content to appear</li>
<li>TTI(time to interact) - time it takes for page to be interactable</li>
<li>FID(first input delay) - time it takes for page to response for first user input</li>
<li>TBT(total blocking time) - time that main thread was blocked</li>
</ul>
<h4 id="rail-model">RAIL model</h4>
<p>RAIL(response, animation, idle, load) - focuses on UX aka performance perceived by user</p>
<ul>
<li>first response of page should take less then 100ms</li>
<li>animation should perform in under 10ms
<ul>
<li>meaning, there shouldn’t be noticeable lags, when activating animation</li>
</ul>
</li>
<li>non-crucial operations should be delayed to time, when page is idling</li>
<li>general load time should be under 1s
<ul>
<li><em>well…it is kinda hard with react :)</em></li>
</ul>
</li>
</ul>
<h4 id="prpl-pattern">PRPL pattern</h4>
<p>PRPL(push, render, pre-cache, lazy-load) - focuses on minimizing time for initial load</p>
<ul>
<li>
<p>similar to RAIL model, it focuses of perceived performance, but in network side</p>
</li>
<li>
<p>push - prioritize crucial resources first, with locating servers as close to user(use CDN)</p>
<ul>
<li>it is sub-optimal to make many requests for each resources
<ul>
<li>when using HTTP/1.1 always use <code dir="auto">keep-alive</code> to reduce TCP handshakes</li>
<li>if possible(if not you can still create HTTP2 optimized setup and use it when possible) you can use HTTP/2, which allows to:
<ul>
<li>batch several requests into one</li>
<li>use bi-directional TCP for each batch(in 1.1 you have pool of only 6 opened TCP connections)
<ul>
<li>not that making a pool bigger can slow down low end devices</li>
</ul>
</li>
<li>server push, meaning when requesting main HTML, server can push additional resources with it(this resources are put in cache)
<ul>
<li>be careful with it, because pushed resourced aren’t cached via HTTP, so caching with service workers is needed</li>
<li>remember that browser cache have limits, so some pushed resources might be ignored</li>
</ul>
</li>
</ul>
</li>
<li>use <code dir="auto">preload</code> for most critical resources</li>
</ul>
</li>
</ul>
</li>
<li>
<p>render - start render as soon as possible, even if something non-important is still loading</p>
</li>
<li>
<p>pre-cache - cache most of needed resources(lower server usage, faster load times, better offline experience(service workers with custom cache are needed))</p>
<ul>
<li>break bundle to small, more cacheable parts
<ul>
<li>changes to app will result in partial cache invalidation</li>
<li>such bundles is easier to defer</li>
<li>remember that no-bundle is an option(BUT FOR SMALL APPS)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>lazy-load - defer load of resources, that out of view</p>
<ul>
<li>service workers are good fit here, because they can load and cache in background additional resources, after main page has loaded</li>
</ul>
</li>
</ul>
<h2 id="css-optimization">CSS optimization</h2>
<p>Big amount of <code dir="auto">var()</code> can cause problems, so you can change vanilla var to preprocessed var from SaaS(or smth else)</p>
<h2 id="lcp">LCP</h2>
<p>Largest Contentful Paint - time diff between beginning of page load and finish of render for  biggest object in VeiwPort</p>
<p>good - &#x3C; 2.5s
poor - > 4s</p>
<p>biggest element is always changing while loading, with end - first user interaction</p>
<p>LCP hack - way to override LCP metric</p>
<ul>
<li>old: add big empty img</li>
<li>after chrome 112: take simple svg, make transparent, convert to base64 with min 3kb</li>
</ul>
<h2 id="caching-headers">Caching Headers</h2>
<p>It is common for most host to have enabled by default caching with smth like <code dir="auto">Cache-Control</code> header of <code dir="auto">public</code>, <code dir="auto">max-age=0</code>, <code dir="auto">must-revalidate</code>, which means: “cache this, but mark as irrelevant(stale), so next request will first go to the server and check for new version”</p>
<ul>
<li>it is basic config, that is good, but can be more aggressive for some cases</li>
<li>server can respond with 200(when no cache) and 304 Not Modified(when cache is relevant)
<ul>
<li>second is still a GET request, but it is a lot faster</li>
</ul>
</li>
</ul>
<p>more aggressive technics</p>
<ul>
<li><code dir="auto">public, max-age=31560000, immutable</code> - for things that can never change(font, image, smth linked over stable URL)
<ul>
<li>explanation
<ul>
<li><code dir="auto">public</code> - asset can be stored in any cache between the browser and origin server</li>
<li><code dir="auto">max-age=31560000</code> - cache will stale after a year</li>
<li><code dir="auto">immutable</code> - prevent additional check to CDN from browser</li>
</ul>
</li>
<li>it is bad practice to mark HTML files like so, case of impossibility to fingerprint them</li>
</ul>
</li>
<li>fingerprinting - change part of URL, when file is changed
<ul>
<li>URL acts as key to cache, so changing URL will force browser to download file, if it’s URL changed, even if previous version was marked as “never changing”</li>
<li>often provided via bundlers</li>
</ul>
</li>
</ul>
<p>don’t forget to check Dev Tools on prod, too find weak places :)</p>
<h2 id="pre-fetching">Pre-Fetching</h2>
<p>Prefetching is a technic, that downloads next possible page/resource, that user might request</p>
<ul>
<li>so next page will load instantaneously or near that, increasing LCP, UX etc</li>
</ul>
<p>it is important to do it wisely, case it increases bandwidth and device resources consumption</p>
<p>main technics</p>
<ul>
<li>prefetch content of visible link, detected by Intersection Observer API</li>
<li>prefetch popular content via data collected from analytics</li>
<li>use Network Information API + Device Memory API to ensure that user have stable network</li>
<li>use <code dir="auto">reqiestIdleCallback</code> API to execute prefetching on next free CPU cycle(or after condition, often deadline, is met)</li>
</ul>
<p>code snipped with fallbacks, done in native JS(but can be implemented via libs or <code dir="auto">rel=prefetch</code> tag)</p>
<div class="expressive-code"><link rel="stylesheet" href="/it_docs/_astro/ec.usa2f.css"><script type="module" src="/it_docs/_astro/ec.sgewm.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">function</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3C63B3">prefetch</span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">nodeLists</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#809191;--1:#5E6578">// Exclude slow ECTs &#x3C; 3g</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#097174">navigator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">connection</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x26;&#x26;</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">    (</span><span style="--0:#7FDBCA;--1:#097174">navigator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">connection</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">effectiveType</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">slow-2g</span><span style="--0:#D9F5DD;--1:#111111">'</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">      </span><span style="--0:#C792EA;--1:#8D46B4">||</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">navigator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">connection</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">effectiveType</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">===</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">2g</span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#D6DEEB;--1:#403F53">)</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  ) {</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#C792EA;--1:#8D46B4">return</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#809191;--1:#5E6578">// Exclude low end device which is device with memory &#x3C;= 2GB</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">if</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#7FDBCA;--1:#097174">navigator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">deviceMemory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x26;&#x26;</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#097174">navigator</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">deviceMemory</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8D46B4">&#x3C;=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#F78C6C;--1:#AA0982">2</span><span style="--0:#D6DEEB;--1:#403F53">) {</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">    </span><span style="--0:#C792EA;--1:#8D46B4">return</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">fetchLinkList</span><span style="--0:#C792EA;--1:#8D46B4"> = {}</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">observer</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#7FDBCA;--1:#097174">new</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#82AAFF;--1:#3C63B3">IntersectionObserver</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">entries</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">    </span><span style="--0:#7FDBCA;--1:#097174">entries</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">forEach</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">entry</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">      if </span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">entry</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">isIntersecting</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">        if </span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">!</span><span style="--1:#403F53"><span style="--0:#D7DBE0">fetchLinkList</span><span style="--0:#D6DEEB">[</span></span><span style="--0:#7FDBCA;--1:#097174">entry</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">target</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">href</span><span style="--0:#D6DEEB;--1:#403F53">])</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">          </span><span style="--1:#403F53"><span style="--0:#D7DBE0">fetchLinkList</span><span style="--0:#D6DEEB">[</span></span><span style="--0:#7FDBCA;--1:#097174">entry</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#FAF39F;--1:#111111">target</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">href</span><span style="--0:#D6DEEB;--1:#403F53">]</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#FF5874;--1:#A54A4A">true</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">          </span><span style="--0:#82AAFF;--1:#3C63B3">fetch</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">entry</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">target</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">            priority: </span><span style="--0:#D9F5DD;--1:#111111">'</span><span style="--0:#ECC48D;--1:#9B504E">low</span><span style="--0:#D9F5DD;--1:#111111">'</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">          }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">        }</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">        </span><span style="--0:#7FDBCA;--1:#097174">observer</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">unobserve</span><span style="--1:#403F53"><span style="--0:#D6DEEB">(</span><span style="--0:#D7DBE0">entry</span></span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#7FDBCA;--1:#097174">entry</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">target</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">      }</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">    }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">  }</span><span style="--0:#D6DEEB;--1:#403F53">);</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">}</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">const </span><span style="--0:#82AAFF;--1:#3C63B3">idleCallback</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#7FDBCA;--1:#097174">window</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#7FDBCA;--1:#097174">requestIdleCallback</span><span style="--0:#C792EA;--1:#8D46B4"> || function </span><span style="--0:#D9F5DD;--1:#111111">(</span><span style="--0:#D7DBE0;--1:#403F53">cb</span><span style="--0:#D9F5DD;--1:#111111">)</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">  let </span><span style="--0:#D7DBE0;--1:#403F53">start</span><span style="--0:#C792EA;--1:#8D46B4"> = </span><span style="--0:#7FDBCA;--1:#097174">Date</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">now</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">  return </span><span style="--0:#82AAFF;--1:#3C63B3">setTimeout</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">    </span><span style="--0:#82AAFF;--1:#3C63B3">cb</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">{</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">      didTimeout: </span><span style="--0:#FF5874;--1:#A54A4A">false</span><span style="--0:#7690A6;--1:#4F687D">,</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">      </span><span style="--0:#82AAFF;--1:#3C63B3">timeRemaining</span><span style="--0:#C792EA;--1:#8D46B4">: function </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#C792EA;--1:#8D46B4"> {</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">        return </span><span style="--0:#7FDBCA;--1:#097174">Math</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">max</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#F78C6C;--1:#AA0982">0</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#F78C6C;--1:#AA0982">50</span><span style="--0:#C792EA;--1:#8D46B4"> - </span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#7FDBCA;--1:#097174">Date</span><span style="--0:#C792EA;--1:#8D46B4">.</span><span style="--0:#82AAFF;--1:#3C63B3">now</span><span style="--0:#D6DEEB;--1:#403F53">()</span><span style="--0:#C792EA;--1:#8D46B4"> - </span><span style="--1:#403F53"><span style="--0:#D7DBE0">start</span><span style="--0:#D6DEEB">))</span></span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">      }</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">    }</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">  }</span><span style="--0:#7690A6;--1:#4F687D">,</span><span style="--0:#C792EA;--1:#8D46B4"> </span><span style="--0:#F78C6C;--1:#AA0982">1</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#C792EA;--1:#8D46B4">;</span></div><div class="ec-line"><span style="--0:#C792EA;--1:#8D46B4">}</span></div><div class="ec-line">
</div><div class="ec-line"><span style="--0:#82AAFF;--1:#3C63B3">idleCallback</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C792EA;--1:#8D46B4">function</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">()</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#82AAFF;--1:#3C63B3">prefetch</span><span style="--1:#403F53"><span style="--0:#D6DEEB">(</span><span style="--0:#D7DBE0">nodeLists</span><span style="--0:#D6DEEB">)</span></span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">})</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="function prefetch(nodeLists) {  // Exclude slow ECTs < 3g  if (navigator.connection &#x26;&#x26;    (navigator.connection.effectiveType === &#x27;slow-2g&#x27;      || navigator.connection.effectiveType === &#x27;2g&#x27;)  ) {    return;  }  // Exclude low end device which is device with memory <= 2GB  if (navigator.deviceMemory &#x26;&#x26; navigator.deviceMemory <= 2) {    return;  }  const fetchLinkList = {};  const observer = new IntersectionObserver(function (entries) {    entries.forEach(function (entry) {      if (entry.isIntersecting) {        if (!fetchLinkList[entry.target.href]) {          fetchLinkList[entry.target.href] = true;          fetch(entry.target, {            priority: &#x27;low&#x27;          });        }        observer.unobserve(entry = entry.target);      }    });  });}const idleCallback = window.requestIdleCallback || function (cb) {  let start = Date.now();  return setTimeout(function () {    cb({      didTimeout: false,      timeRemaining: function () {        return Math.max(0, 50 - (Date.now() - start));      }    });  }, 1);}idleCallback(function () {  prefetch(nodeLists)})"><div></div></button></div></figure></div>
<h2 id="low-quality-image-placeholder">Low Quality Image Placeholder</h2>
<p>It is common that images weight more that HTML+CSS on your page and while they don’t block rendering, it is affecting UX</p>
<p>Except of caching, pre-loading, skeletons and compression, there is other technique, replacing images with low quality placeholder, which is increasing UX, by giving the user smth to look at</p>
<ul>
<li>it is also possible to improve LCP score, but it can be tricky to align loading speed
<ul>
<li>basically Chrome finds larges element on page and tries to find larges before ~2.5s passes or user interacts with page</li>
<li>same size elements won’t trigger change, with some nuances to prevent LCP Hacks:
<ul>
<li>upscaled version of image will be replaced with more quality one
<ul>
<li>simplifying image area is calculated via: <code dir="auto">area = size * min(displaySize, naturalSize) / displaySize</code>
<ul>
<li><code dir="auto">size</code> is what eventually user sees</li>
<li><code dir="auto">displaySize</code> is what rendered, but can be cropped or out of viewport</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>general rule of thumb keep UX > LCP Hacking</li>
</ul>
</li>
</ul>
<p>rules:</p>
<ul>
<li>don’t simply downscale images</li>
<li>image must be “dense”, meaning that 1 pixel must contain .055 bits of data after all rendering and cuts</li>
<li>it is ok to make image larger than minimum requirements for LCP, if it is beneficial to UX</li>
<li>it is better to use images processing services like <a href="https://cloudinary.com/">Cloudinary</a>, which is platform that lets you store your images and receive different quality versions of it when needed</li>
</ul>
<p>how to with bg-img</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;</span><span style="--0:#CAECE6">head</span><span style="--0:#7FDBCA">></span></span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;</span><span style="--0:#CAECE6">link</span><span style="--0:#7FDBCA"> </span></span><span style="--0:#C5E478;--1:#3C63B3">rel</span><span style="--0:#7FDBCA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">preload</span><span style="--0:#7FDBCA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">as</span><span style="--0:#7FDBCA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">image</span><span style="--0:#7FDBCA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">href</span><span style="--0:#7FDBCA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">lo-res.jpg</span><span style="--0:#7FDBCA;--1:#8D46B4"> </span><span style="--0:#C5E478;--1:#3C63B3">fetchpriority</span><span style="--0:#7FDBCA;--1:#8D46B4">=</span><span style="--0:#ECC48D;--1:#3C63B3">high</span><span style="--0:#7FDBCA;--1:#8D46B4"> /></span></div><div class="ec-line"><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;/</span><span style="--0:#CAECE6">head</span><span style="--0:#7FDBCA">></span></span></div><div class="ec-line">
</div><div class="ec-line"><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;</span><span style="--0:#CAECE6">body</span><span style="--0:#7FDBCA">></span></span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;</span><span style="--0:#CAECE6">header</span><span style="--0:#7FDBCA"> </span></span><span style="--0:#C5E478;--1:#3C63B3">style</span><span style="--0:#7FDBCA;--1:#8D46B4">=</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#9B504E">background-image: url(hi-res.jpg),</span></div><div class="ec-line"><span style="--0:#ECC48D;--1:#9B504E">                                   url(lo-res.jpg)</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#7FDBCA;--1:#8D46B4">></span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;/</span><span style="--0:#CAECE6">header</span><span style="--0:#7FDBCA">></span></span></div><div class="ec-line"><span style="--1:#8D46B4"><span style="--0:#7FDBCA">&#x3C;/</span><span style="--0:#CAECE6">body</span><span style="--0:#7FDBCA">></span></span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="<head>  <link rel=preload as=image href=lo-res.jpg fetchpriority=high /></head><body>  <header style=&#x22;background-image: url(hi-res.jpg),                                   url(lo-res.jpg)&#x22;>  </header></body>"><div></div></button></div></figure></div>
<p>it is working, case CSS will display first account on what image is loaded and after that on order</p>
<ul>
<li>thats why we are preloading, we need for our image to be on screen “instantaneously” and not race with <code dir="auto">hi-res</code></li>
<li>as good rule, we can add <code dir="auto">bg-color</code> to prevent no bg at all, if no image loaded yet
<ul>
<li>to increase UX we can use ultra low quality image to prevent <code dir="auto">bg-color</code> from appearing at all(in most cases), but it won’t help with LCP</li>
</ul>
</li>
</ul>
<p>how to with img:</p>
<ul>
<li>we can use semantic <code dir="auto">img</code> with <code dir="auto">src</code> set to <code dir="auto">hi-res</code> image and set <code dir="auto">bg-image</code> to <code dir="auto">lo-res</code></li>
</ul>
<h2 id="dev-tools">Dev Tools</h2>
<p>Many browsers have dev tools, aka tools that help developing web apps</p>
<p>Main standard is Chrome Dev Tools, that have number of possibilities, some of them are:</p>
<ul>
<li><code dir="auto">Elements</code> - inspect HTML+CSS</li>
<li><code dir="auto">Console</code> - work with JS</li>
<li><code dir="auto">Network</code> - request/response view + network performance analyze</li>
<li><code dir="auto">Performance</code> - performance :)</li>
<li><code dir="auto">Application</code> - managing page resources, such as Storages, Cookies etc</li>
</ul>
<h2 id="lighthouse">Lighthouse</h2>
<p>Lighthouse - tool for auditing performance, accessibility and CEO of websites</p>
<ul>
<li>good starting point to investigate week places of page</li>
<li>can give CEO boost, because involved in google search engine to determine website quality</li>
</ul>
<p>key measurement:</p>
<ul>
<li>load time</li>
<li>first paint</li>
<li>time to interact</li>
<li>accessibility
<ul>
<li>missing <code dir="auto">alt</code></li>
<li>broken links</li>
<li>incorect image sizes</li>
</ul>
</li>
</ul>
<h2 id="caching">Caching</h2>
<p>Basically it is about storing some frequently accessed data in temp storage(cache), that can return this data faster than actual storage</p>
<ul>
<li>it is important not to break data integrity, by serving some obsolete information from cache, so cache invalidation is important</li>
<li>everything can be cached: static files, query responses, API calls</li>
</ul>
<p>Benefits:</p>
<ul>
<li>improved UX, by reducing latency and network usage</li>
<li>improved backend, by lowering server load</li>
</ul>
<h4 id="cache-types">Cache Types</h4>
<ul>
<li>in-memory - storing data in RAM
<ul>
<li>useful for servers and databases, case we reducing number of costly I/O operations</li>
<li>it is important not to store data changes in RAM, because it is can be lost</li>
</ul>
</li>
<li>distributed - storing data in multiple nodes in network
<ul>
<li>useful for some highload servers</li>
<li>prevents data loss, but harder+costly to setup/operate</li>
<li>simple example: create a Redis layer of cache and look there first
<ul>
<li>more complicated version can have multiple Redis nodes, that falls back to nearest DB, that duplicates main DB</li>
</ul>
</li>
</ul>
</li>
<li>client side - storing data in the client
<ul>
<li>useful to reduce number of requests from client(UX and server boost) for some static content
<ul>
<li>also can be used to cache API calls in-memory or via Storage API</li>
</ul>
</li>
<li>it is important to be careful with caching policies, to prevent stale data</li>
</ul>
</li>
</ul>
<h4 id="caching-stratagies">Caching Stratagies</h4>
<ul>
<li>aside(client side caching) - caching inside app
<ul>
<li>be careful with stale cache</li>
</ul>
</li>
<li>write-through - write to cache and then to DB, keeping cache up-to-date
<ul>
<li>slower writes</li>
</ul>
</li>
<li>write-behind - similar to write-through, but with batching writes
<ul>
<li>a bit slower writes</li>
<li>possibility of inconsistent data</li>
</ul>
</li>
<li>read-through - read from cache, with fallback to DB
<ul>
<li>slower reads</li>
<li>beneficial for rarely changing data, slow DBs</li>
</ul>
</li>
</ul>
<h4 id="measuring-cache-effectiveness">Measuring cache effectiveness</h4>
<p>Cache is always introducing some tradeoffs, so it is important to measure and choose right one</p>
<ul>
<li>measuring cache hit rate - calculating how often we avoiding DB operations and using cache
<ul>
<li>formula: <code dir="auto">cacheCalls/allCalls</code></li>
</ul>
</li>
<li>analyze cache eviction rate - measure how much items are removed from cache due to it’s size or expiration data
<ul>
<li>too high count can be evidence to improve parameters above</li>
<li>be careful with caching by time with too big values(or even by time at all, because it is more stale-affected and not as efficient as other strategies)</li>
</ul>
</li>
<li>monitor data consistency - check if cache serves inconsistent data, by comparing it with actual one</li>
</ul> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/it_docs/all/js/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">JS</span> </span> </a> <a href="/it_docs/all/react/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">React</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>