<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar data-theme="dark" class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>System_Design | IT Docs</title><link rel="canonical"/><link rel="shortcut icon" href="/it_docs/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v4.4.4"/><meta name="generator" content="Starlight v0.19.1"/><meta property="og:title" content="System_Design"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description"/><meta property="og:site_name" content="IT Docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="System_Design"/><meta name="twitter:description"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/it_docs/_astro/index.BsC2KTtW.css" /><script type="module" src="/it_docs/_astro/hoisted.Bn7iS9oN.js"></script>
<script type="module" src="/it_docs/_astro/page.CZ0TFQCk.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/it_docs/" class="site-title sl-flex astro-m46x6ez3">  <span class="astro-m46x6ez3"> IT Docs </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/GGsmou" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Overview</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/it_docs/all/algorithms__data_structures/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Algorithms and Data Structures</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/architecture/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Architecture</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/backend/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">BackEnd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/cli/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/code_complete_2-steve_mcconnel/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Notes of &quot;Code Complete 2nd edition&quot; by Steve McConnel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/code_snippets/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Code_Snippets</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/css/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">CSS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/design/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Design</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/domain_driven_design-evans/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Notes of &quot;Domain Driven Design&quot; by Evans</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/fintech/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fintech</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/frontend/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">FrontEnd</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/general/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">General</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/it/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">IT</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/js/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">JS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/nodejs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">NodeJS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/optimization/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Optimization</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/react/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">React</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/security/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Security</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/software_engineering_at_google-oreilly/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Notes of &quot;Software Engineering at Google&quot; by O&#39;Reilly</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/system_design/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">System_Design</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/testing/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Testing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/it_docs/all/ts/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">TS</span>  </a> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://github.com/GGsmou" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="6" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#interview" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Interview</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#how-to-design" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">How to design</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#url-shortener" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">URL Shortener</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#cdn" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">CDN</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#whatsapp-chat-app" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Whatsapp (chat app)</span> </a>  </li> </ul>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#api-design" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">API Design</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main-types" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main Types</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#communication-strategy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Communication Strategy</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#scalability" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Scalability</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#replication" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Replication</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#partitioning" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Partitioning</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sharding" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Sharding</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#load-balancing" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Load Balancing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#api-gateway" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">API Gateway</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#caching" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Caching</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#types" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Types</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#main-terms" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Main terms</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#strategies" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Strategies</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#implementations" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#use-cases" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Use-Cases</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#invalidation-strategies" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Invalidation strategies</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#cache-eviction" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Cache eviction</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#common-problems" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Common problems</span> </a>  </li> </ul>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#other-concepts" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Other concepts</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#single-sign-on-sso" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Single Sign-On (SSO)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#db-design" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">DB Design</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sqlrelational-db-vs-nosqlnon-relational-db" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">SQL(relational DB) vs NoSQL(non relational DB)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#db-indexing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">DB indexing</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#proxy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Proxy</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#forward-proxy-vs-reverse-proxy" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Forward Proxy vs Reverse Proxy</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#serverless" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Serverless</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#authentication" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Authentication</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#jwt-json-web-token" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">JWT (JSON Web Token)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#oauth" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">OAuth</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#saml-security-assertion-markup-language" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">SAML (Security Assertion Markup Language)</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#related-algorithms-and-data-structures" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Related Algorithms and Data Structures</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#encryption" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Encryption</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#symmetric-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Symmetric Encryption</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#asymmetric-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Asymmetric Encryption</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#e2e-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">E2E Encryption</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#transit-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Transit Encryption</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#technologies" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Technologies</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#redis" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Redis</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#kafka" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Kafka</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#rabbitmq" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">RabbitMQ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#aws-elasticsearch" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">AWS Elasticsearch</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#docker" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Docker</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#kubernetes" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Kubernetes</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12-factors-of-scalable-service" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">12 factors of scalable service</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#factors" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Factors</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#synchronization-methods" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Synchronization Methods</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#mutex" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Mutex</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#semaphore" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Semaphore</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#blob-storage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Blob Storage</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#block-storage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Block Storage</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#m3u-files" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">M3U Files</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#recommendation-algorithm" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Recommendation Algorithm</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#designing-distributed-systems" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Designing Distributed Systems</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#intro" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Intro</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#history" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">History</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#the-value-of-patterns" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">The value of patterns</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#single-node-patterns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Single-Node Patterns</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#single-node" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Single-Node</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 3;"> <li class="astro-g2bywc46" style="--depth: 3;"> <a href="#motivation" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Motivation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sidecar" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Sidecar</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#ambassador" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Ambassador</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#adapter" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Adapter</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#serving-patterns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Serving Patterns</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#replicated-load-balancer" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Replicated Load-Balancer</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sharded-service" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Sharded Service</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 3;"> <li class="astro-g2bywc46" style="--depth: 3;"> <a href="#distributed-cache" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Distributed Cache</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 3;"> <a href="#sharding-function" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Sharding Function</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#scattergather" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Scatter/Gather</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#event-driven-processing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Event-Driven Processing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#ownership-election" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Ownership Election</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 3;"> <li class="astro-g2bywc46" style="--depth: 3;"> <a href="#sharing-resources" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Sharing resources</span> </a>  </li> </ul>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#batch-computational-patterns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Batch Computational Patterns</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#work-queue" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Work Queue</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#event-driven-batch-processing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Event-Driven Batch Processing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#coordinated-batch-processing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Coordinated Batch-Processing</span> </a>  </li> </ul>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="6"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#interview" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Interview</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#how-to-design" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">How to design</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#url-shortener" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">URL Shortener</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#cdn" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">CDN</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#whatsapp-chat-app" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Whatsapp (chat app)</span> </a>  </li> </ul>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#api-design" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">API Design</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#main-types" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Main Types</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#communication-strategy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Communication Strategy</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#scalability" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Scalability</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#replication" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Replication</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#partitioning" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Partitioning</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sharding" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Sharding</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#load-balancing" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Load Balancing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#api-gateway" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">API Gateway</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#caching" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Caching</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#types" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Types</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#main-terms" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Main terms</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#strategies" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Strategies</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#implementations" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#use-cases" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Use-Cases</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#invalidation-strategies" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Invalidation strategies</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#cache-eviction" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Cache eviction</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#common-problems" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Common problems</span> </a>  </li> </ul>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#other-concepts" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Other concepts</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#single-sign-on-sso" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Single Sign-On (SSO)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#db-design" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">DB Design</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sqlrelational-db-vs-nosqlnon-relational-db" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">SQL(relational DB) vs NoSQL(non relational DB)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#db-indexing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">DB indexing</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#proxy" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Proxy</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#forward-proxy-vs-reverse-proxy" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Forward Proxy vs Reverse Proxy</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#serverless" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Serverless</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#authentication" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Authentication</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#jwt-json-web-token" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">JWT (JSON Web Token)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#oauth" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">OAuth</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#saml-security-assertion-markup-language" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">SAML (Security Assertion Markup Language)</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#related-algorithms-and-data-structures" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Related Algorithms and Data Structures</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#encryption" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Encryption</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#symmetric-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Symmetric Encryption</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#asymmetric-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Asymmetric Encryption</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#e2e-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">E2E Encryption</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#transit-encryption" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Transit Encryption</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#technologies" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Technologies</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#redis" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Redis</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#kafka" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Kafka</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#rabbitmq" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">RabbitMQ</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#aws-elasticsearch" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">AWS Elasticsearch</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#docker" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Docker</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#kubernetes" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Kubernetes</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#12-factors-of-scalable-service" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">12 factors of scalable service</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#factors" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Factors</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#synchronization-methods" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Synchronization Methods</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#mutex" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Mutex</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#semaphore" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Semaphore</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#blob-storage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Blob Storage</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#block-storage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Block Storage</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#m3u-files" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">M3U Files</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#recommendation-algorithm" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Recommendation Algorithm</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#designing-distributed-systems" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Designing Distributed Systems</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#intro" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Intro</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#history" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">History</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#the-value-of-patterns" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">The value of patterns</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#single-node-patterns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Single-Node Patterns</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#single-node" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Single-Node</span> </a> <ul class="astro-g2bywc46" style="--depth: 3;"> <li class="astro-g2bywc46" style="--depth: 3;"> <a href="#motivation" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Motivation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sidecar" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Sidecar</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#ambassador" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Ambassador</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#adapter" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Adapter</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#serving-patterns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Serving Patterns</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#replicated-load-balancer" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Replicated Load-Balancer</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#sharded-service" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Sharded Service</span> </a> <ul class="astro-g2bywc46" style="--depth: 3;"> <li class="astro-g2bywc46" style="--depth: 3;"> <a href="#distributed-cache" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Distributed Cache</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 3;"> <a href="#sharding-function" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Sharding Function</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#scattergather" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Scatter/Gather</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#event-driven-processing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Event-Driven Processing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#ownership-election" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Ownership Election</span> </a> <ul class="astro-g2bywc46" style="--depth: 3;"> <li class="astro-g2bywc46" style="--depth: 3;"> <a href="#sharing-resources" class="astro-g2bywc46" style="--depth: 3;"> <span class="astro-g2bywc46" style="--depth: 3;">Sharing resources</span> </a>  </li> </ul>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#batch-computational-patterns" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Batch Computational Patterns</span> </a> <ul class="astro-g2bywc46" style="--depth: 2;"> <li class="astro-g2bywc46" style="--depth: 2;"> <a href="#work-queue" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Work Queue</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#event-driven-batch-processing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Event-Driven Batch Processing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 2;"> <a href="#coordinated-batch-processing" class="astro-g2bywc46" style="--depth: 2;"> <span class="astro-g2bywc46" style="--depth: 2;">Coordinated Batch-Processing</span> </a>  </li> </ul>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">System_Design</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <blockquote>
<p>Scale when needed, not because you can or it is popular
<em>this applies using vertical scaling first, until it is too expensive OR impossible(bandwidth)</em></p>
</blockquote>
<p><img  src="/it_docs/_astro/it_9.GZuTMKm3_Z1lQQge.webp" alt="" width="800" height="997" loading="lazy" decoding="async"></p>
<p><img  src="/it_docs/_astro/it_8.Ypz_MwrT_Zb8ozF.webp" alt="" width="1600" height="2329" loading="lazy" decoding="async"></p>
<h2 id="interview">Interview</h2>
<ul>
<li>
<p>always start with understanding problem and gathering relevant details</p>
<ul>
<li>relevant details: why we need this system, what functional will be included into system, requirements(functional and non-functional)
<ul>
<li>functional requirements - describe what tasks system must perform</li>
<li>non-functional requirements - describe how and on what constrains system must perform</li>
</ul>
</li>
<li>when stating some requirement, explain why it is relevant</li>
</ul>
</li>
<li>
<p>define system constrains and estimates:</p>
<ul>
<li>estimate priority (reads OR writes)</li>
<li>estimate number of: request per second, needed storage, bandwidth used</li>
</ul>
</li>
<li>
<p>define large parts of system and broadly APIs, define each part of a system in details, refine and repeat</p>
</li>
<li>
<p>discuss bottlenecks and solutions</p>
</li>
<li>
<p>summarize the decisions with possible alternatives</p>
<ul>
<li>summarize the achievement of requirements</li>
</ul>
</li>
<li>
<p>when considering if improvements to system are needed remember about:</p>
<ul>
<li>any change need to be justified by statistics</li>
<li>how much money will be spent AND earned after improvement</li>
</ul>
</li>
</ul>
<p>all systems have several attributes, attached to them</p>
<ul>
<li>prioritizing one attribute might negatively impact other
<ul>
<li>ex: more security == less UX</li>
</ul>
</li>
</ul>
<h4 id="how-to-design">How to design</h4>
<h6 id="url-shortener">URL Shortener</h6>
<ul>
<li>why we need it
<ul>
<li>optimize link size</li>
<li>hide original URLs (ex: affiliated links)</li>
<li>track link performance</li>
</ul>
</li>
<li>functional requirements
<ul>
<li>given URL service must return short/custom alias for it</li>
<li>when alias is accessed, user is redirected to original URL</li>
<li>each alias must have expiration time, with possibility to override it</li>
</ul>
</li>
<li>non-functional requirements
<ul>
<li>high availability</li>
<li>redirects must happen with minimal latency</li>
<li>short links can’t be predicted</li>
</ul>
</li>
<li>extended requirements:
<ul>
<li>performance tracking</li>
<li>public REST API</li>
</ul>
</li>
<li>assumptions and constraints
<ul>
<li>New URLs - 200/s || URL redirections - 20K/s || Incoming data - 100KB/s || Outgoing data - 10MB/s || Storage for 5 years - 15TB || Memory for cache - 170GB</li>
</ul>
</li>
<li>API
<ul>
<li>Public API can be based on REST
<ul>
<li>example of endpoint: alias, that will expose CREATE, PUT, DELETE, GET</li>
</ul>
</li>
<li>RateLimiting
<ul>
<li>can be done per-customer, by API_DEV_KEY</li>
<li>can be done per-api to prevent DDOS</li>
</ul>
</li>
</ul>
</li>
<li>DB Design
<ul>
<li>notes:
<ul>
<li>service is read heavy</li>
<li>billion of records will be stored</li>
<li>each record is small</li>
</ul>
</li>
<li>schema:
<ul>
<li>user &#x3C;- alias</li>
</ul>
</li>
<li>technologie: NoSQL
<ul>
<li>reasons: low number of relationships, billion of records, easy to scale</li>
</ul>
</li>
</ul>
</li>
<li>Main algorithm variants:
<ul>
<li>encode actual URL into SHA256(or similar) hash format + transform it to readable, fixed size string via Base64 + crop part of it
<ul>
<li>6 chars length is sufficient enough and will produce 64^6 variations</li>
<li>problems:
<ul>
<li>by slicing part of string repetition may occur - add shuffling to mitigate it</li>
<li>same URLs will produce same aliases - add salting OR user metadata(performance impact)</li>
</ul>
</li>
<li>to mitigate uniqueness problem we need to add retries</li>
</ul>
</li>
<li>generate keys before-hand and store in DB, serve keys on demand
<ul>
<li>benefits:
<ul>
<li>easy, cheap and fast solutions, with no collision problems</li>
</ul>
</li>
<li>problems:
<ul>
<li>concurrency
<ul>
<li>move part of keys into memory and serve directly from there to avoid concurrency in-between slow calls to DB</li>
<li>mutex OR synchronization is required</li>
</ul>
</li>
<li>single point of failure
<ul>
<li>introduce replica</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Additions:
<ul>
<li>redirect is done via 302 (Redirect) response
<ul>
<li>failing look-up should resolve into 404 OR redirect to default page</li>
</ul>
</li>
<li>we should allow custom aliases with more then 6 chars, BUT prevent too large strings</li>
</ul>
</li>
<li>Partitioning - to allow storing billions of URLs we should partition data, some variations can be:
<ul>
<li>alphabetic range base - can lead to unbalanced partitioning</li>
<li>hashing - with consistent hashing algorithm, to make partitioning balanced</li>
</ul>
</li>
<li>Cache
<ul>
<li>tech: memcached OR redis</li>
<li>how much: based on predictions it is enough to have one large machine, that will cache ~20% of URLs(hot URLs)
<ul>
<li>but it is totally possible to have clusters of several machines</li>
</ul>
</li>
<li>LRU is great technique for high reads and storing only hot URLs</li>
<li>if needed we can replicate our clusters
<ul>
<li>each replica can populate itself independently via read-through approach</li>
</ul>
</li>
</ul>
</li>
<li>Load Balancing
<ul>
<li>it needs to be placed between: Client-Server, Server-DB, Server-Cache</li>
</ul>
</li>
<li>DB clean-up
<ul>
<li>don’t serve expired links to users</li>
<li>freed key can be restored keyDB</li>
<li>cleaning strategies:
<ul>
<li>separate light-weight service, that runs in periods of low load and clean expired data in batches</li>
<li>remove on read request</li>
</ul>
</li>
</ul>
</li>
<li>telemetry - can be implemented as separate service, with separate DB(for country, number of visits, user info, source of URL etc per-url) and be write focused(write-back technique)
<ul>
<li>don’t forget to clear telemetry after some period of URL expiration</li>
</ul>
</li>
<li>it is possible to introduce user permissions per each URL</li>
</ul>
<h6 id="cdn">CDN</h6>
<ul>
<li>what is it - geographically distributed network of data-servers, that has main goal to deliver data fast and reliable
<ul>
<li>it caches content on edge servers(small server, that located as close as possible to client)</li>
</ul>
</li>
<li>why we need it
<ul>
<li>reduce network latency</li>
<li>load balancing</li>
<li>remove single point of failure</li>
</ul>
</li>
<li>main components:
<ul>
<li>client</li>
<li>routing - distributes load, removes inactive sources from rotation, finds shortest route to the data</li>
<li>API Gateway - rate limiting, DDOS protection etc</li>
<li>proxy/edge services - serve content as close as possible to client
<ul>
<li>here content is cached, to reduce number of requests to origin</li>
</ul>
</li>
<li>distribution system - sync content from main cluster with edge servers</li>
<li>content optimization service - reduce size of data</li>
<li>origin server - stores original content</li>
<li>logging &#x26; monitoring</li>
<li>management system - exposed part for user in form of public API (or web-app), that used for configuration, data management etc</li>
<li>load balancing is placed between major nodes</li>
</ul>
</li>
<li>caching
<ul>
<li>push - when new content appears, it is pushed from origin to edge</li>
<li>pull - cache is updated on demand</li>
</ul>
</li>
<li>routing:
<ul>
<li>how to find nearest proxy:
<ul>
<li>network distance - shorter path + higher bandwidth == preferable proxy</li>
<li>load - if edge is overloaded, request won’t be routed here</li>
</ul>
</li>
<li>ways to implement:
<ul>
<li>DNS redirect</li>
<li>anycast - all proxies will have same IP, while Anycast system will choose the most preferable one</li>
<li>client multiplexing - establish multiple connections and serve content from fastest</li>
<li>HTTP redirects</li>
</ul>
</li>
<li>to achieve higher speeds and scalability, routing can be done in tree like shape, with more efficient nodes(one or several of them) placed in the middle between origin and edge</li>
</ul>
</li>
<li>fault tolerance:
<ul>
<li>if child fails - redirect client to other child</li>
<li>if middle-man fails - redirect child to other middle man</li>
<li>if origin fails - use replica OR, as last resort, serve content from middle-mans’ caches</li>
</ul>
</li>
<li>examples: Cloudflare, Cloudfront etc</li>
</ul>
<h6 id="whatsapp-chat-app">Whatsapp (chat app)</h6>
<ul>
<li>requirements
<ul>
<li>functional
<ul>
<li>conversations - one to one, group</li>
<li>acknowledgment - track message status</li>
<li>sharing - sending files(images, videos, audios)</li>
<li>chat storage - messages should be persistently stored, even if user is sent them, been offline</li>
<li>notifications - new messages should result in notifications</li>
</ul>
</li>
<li>non-functional
<ul>
<li>low latency</li>
<li>messages order consistency</li>
<li>availability (can be compromised, if it will increase consistency)</li>
<li>security - done via e2e encryption, where only people, that chatting, can see the contents of messages</li>
<li>scalability</li>
</ul>
</li>
</ul>
</li>
<li>high-level design
<ul>
<li>userA establishes websocket connection with server, sends encrypted message to server, server acknowledges, server holds message until userB is online, server sends message to userB, userB acknowledges, server notifies userA that message is sent, userB reads, userB notifies server that message was read, server notifies userA that message was read</li>
<li>data model design:
<ul>
<li>users</li>
<li>user_groups</li>
<li>user_chats</li>
<li>groups</li>
<li>chats</li>
<li>messages</li>
</ul>
</li>
<li>API:
<ul>
<li>can be done via REST for broad support</li>
<li>file upload can be done as two step process:
<ul>
<li>upload file, receive URL</li>
<li>share URL via message in specific format</li>
</ul>
</li>
</ul>
</li>
<li>architecture: micro-services, because it is easy to scale and decouple</li>
</ul>
</li>
<li>low-level design
<ul>
<li>users connect to WebsocketService, through load-balancer
<ul>
<li>mapping and management is done via WebsocketManagerService</li>
<li>WebsocketManager is connected to Redis cluster to store any needed data</li>
</ul>
</li>
<li>all messages can be retrieved from MessageService, that is connected to some persistence-first DB, like Mnesia
<ul>
<li>it exposes APIs to manipulate messages</li>
<li>it has auto-purging of historical data</li>
<li>messages will be retrieved and stored in encrypted format</li>
</ul>
</li>
<li>all file operations are done via FileService
<ul>
<li>compression and encryption is done on device</li>
<li>blob storage is used to store files</li>
<li>each file is tracked via public id(for sharing) AND via private hash(to avoid duplicated data)</li>
<li>frequently used files can be pushed to CDN</li>
</ul>
</li>
<li>group messages can be routed to specific GroupMessageService, that will route it to Kafka. GroupMessageService communicates with GroupService to retrieve info about each group participant and sends messages to each user
<ul>
<li>GroupService will have SQL-based DB, for ease of working with relational data
<ul>
<li>this DB can be replicated geographically</li>
<li>Redis is needed as cache here</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>non-functional requirements achievement
<ul>
<li>low latency
<ul>
<li>CDN, geographical replication, caching</li>
</ul>
</li>
<li>messages order consistency
<ul>
<li>FIFO queueing, acknowledgment mechanisms, persistence DB</li>
</ul>
</li>
<li>availability
<ul>
<li>data replication, multiple load-balanced servers</li>
</ul>
</li>
<li>security
<ul>
<li>e2e encryption</li>
</ul>
</li>
<li>scalability
<ul>
<li>horizontal via micro-services</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="api-design">API Design</h2>
<p>Describe how each part of the system works and why</p>
<h4 id="main-types">Main Types</h4>
<ul>
<li>REST
<ul>
<li>flexible, data-oriented, has mass adoption</li>
<li>JSON and text based protocols</li>
<li>used for Web products, public/internal APIs, cloud apps</li>
</ul>
</li>
<li>RPC
<ul>
<li>high performant</li>
<li>JSON, protobuf(have lover support, because uses bites to communicate)</li>
<li>used for IoT, microservice architecture</li>
</ul>
</li>
<li>GraphQL
<ul>
<li>single endpoint, strongly typed and self documented</li>
<li>poor performance, has security risks</li>
<li>used for complex APIs</li>
</ul>
</li>
</ul>
<h4 id="communication-strategy">Communication Strategy</h4>
<ul>
<li>sync - all requests done in sync, via HTTP</li>
<li>async messaging - service post messages into queue and subscribe to it, to receive any response messages
<ul>
<li>usually done in 1 to 1 manner</li>
</ul>
</li>
<li>publish-subscribe - service producer publishes messages into shared topic, services consumers can subscribe and receive any messages from this topic
<ul>
<li>done in 1 to many manner</li>
</ul>
</li>
</ul>
<h2 id="scalability">Scalability</h2>
<p>Thing about how many users and requests system needs to handle. What types of this requests(reads or writes)</p>
<p>types:</p>
<ul>
<li>vertical - add more machine power for single machine</li>
<li>horizontal - add more machines and distribute load</li>
</ul>
<h4 id="replication">Replication</h4>
<p>Process of copying data, that has several purposes:</p>
<ul>
<li>creating back-ups</li>
<li>hosting data near locations of usage(US region, EU region etc)</li>
</ul>
<p>Depending on purpose you need to consider several questions:</p>
<ul>
<li>is data need to be replicated?</li>
<li>how often replications will happen?</li>
<li>how accurate duplications need to be?</li>
</ul>
<h4 id="partitioning">Partitioning</h4>
<p>Process of breaking large DB into some logical parts, that will be stored on the same/external server, in order to make DBs more manageable, faster and more available</p>
<ul>
<li>the general focus of partitioning is to reduce cost of queering large data sets</li>
</ul>
<p>examples</p>
<ul>
<li>introduce numeric ID per data-entry and partition by ranges</li>
<li>partition by date ranges
<ul>
<li>great for migrations, because you can migrate only relevant data and keep historical partially empty</li>
</ul>
</li>
</ul>
<p>types</p>
<ul>
<li>vertical - each partition will have subset of columns + some key to connect them
<ul>
<li>great for splitting many columns and queering commonly used separately from less ussed</li>
</ul>
</li>
<li>horizontal - all columns stays the same, only rows are partitioned
<ul>
<li>optionally, data is distributed across several independent servers</li>
</ul>
</li>
</ul>
<p>benefits:</p>
<ul>
<li>higher response times, faster reads-writes, higher availability</li>
<li>faster maintenance(back-ups, migrations etc)</li>
<li>more storage per partition
<ul>
<li>several servers only</li>
</ul>
</li>
<li>outages are isolated
<ul>
<li>several servers only</li>
</ul>
</li>
<li>access control per partition
problems:</li>
<li>introduces complexity</li>
<li>higher possibility of errors</li>
<li>poor and unbalanced partitioning will slow down system</li>
<li>takes more space</li>
</ul>
<h6 id="sharding">Sharding</h6>
<p>Type of horizontal partitioning, where we break large data into small chunks(shards) and store each shard/collection of shards in separate machines</p>
<p>To query data you generate and assign shard-keys per shard</p>
<ul>
<li>example: store users in shards, depending on their region, so all US users will be in US shard and all EU users in EU shard, thus making most of calls from each regions more optimized(request takes less time to travel), without overhead of full doing DB replication
<ul>
<li>note: we aren’t accounting for number of users per region, thus US shard can be much larger and require separate sharding step, in comparison to Australia</li>
</ul>
</li>
</ul>
<p>great for dealing with traffic and data amount grows</p>
<h4 id="load-balancing">Load Balancing</h4>
<p>Technique to evenly distribute traffic amount several machines for efficiency benefits</p>
<p>use-cases:</p>
<ul>
<li>traffic distribution</li>
<li>ensuring high availability by avoiding routing to inactive machines</li>
<li>session maintenance</li>
<li>SSL/encryption related operations</li>
</ul>
<p>general approach is to take request and pass it to other machine, based on some algorithm, where algorithm can be:</p>
<ul>
<li>static - proxy requests, without consideration about current state of machines
<ul>
<li>basically divide equally all requests</li>
<li>easy to do, BUT will be less efficient, because some machines will become overloaded after some time</li>
</ul>
</li>
<li>dynamic - proxy requests, based on health(availability, load) of each server
<ul>
<li>poll each server from time to time to receive it’s status and distribute load accordingly</li>
<li>failover mechanism is needed, to reroute all requests from failed server to stable one</li>
<li>harder to setup(each server must have endpoint to check it’s health)</li>
<li>sub-types: by connection, by location etc</li>
</ul>
</li>
</ul>
<p>balancing can be used on the gateway to your system OR inside of it between servers and services</p>
<h4 id="api-gateway">API Gateway</h4>
<p>Technique to create single entry point to system, that can handle several functions:</p>
<ul>
<li>authN + authR</li>
<li>caching</li>
<li>request transformation + protocol transformation</li>
<li>rate limiting - limit number of requests per some amount of time
<ul>
<li>usually done by tracking how much time elapsed from previous requests from same IP(or by signing each request with some other metadata)</li>
<li>response from rate limiter can be either 429(too many request) OR requests can be held in some queue</li>
</ul>
</li>
<li>routing, versioning etc AKA reverse proxy</li>
<li>monitoring + logging</li>
<li>serverless functions</li>
</ul>
<p>problems to address:</p>
<ul>
<li>single point of failure
<ul>
<li>as any single entry point to the system</li>
<li>to address: replicate and load balance</li>
</ul>
</li>
<li>additional network overhead(risk of failing requests, requests take longer)</li>
<li>raise of system complexity and additional maintenance</li>
<li>security miss-configurations</li>
</ul>
<h4 id="caching">Caching</h4>
<h6 id="types">Types</h6>
<p>in-memory - data stored in RAM, so there is no need to add network overhead, BUT this way cache can be only local</p>
<p>shared - cache stored on separate machine, so it is accessible to all services</p>
<ul>
<li>cache is available, even if some service failed</li>
<li>cache is consistent for each machine, so no need to create local caches</li>
<li>problems:
<ul>
<li>network overhead is present</li>
</ul>
</li>
</ul>
<h6 id="main-terms">Main terms</h6>
<ul>
<li>number of items cached</li>
<li>how much RAM or Disk Space is consumed by cache</li>
<li>cache miss &#x26; hit - on way to measure cache effectiveness is to look how often we hit it, instead of going to DB or doing requests etc</li>
</ul>
<h6 id="strategies">Strategies</h6>
<ul>
<li>write-through - data is saved into main storage + cache at the same time
<ul>
<li>all writes are slower</li>
</ul>
</li>
<li>read-through - when request misses cache, cache holds request, auto-populates itself from DB and returns response
<ul>
<li>non-cached reads are slower</li>
</ul>
</li>
<li>cache-aside - when request misses cache, system goes into DB instead, populates cache and returns response
<ul>
<li>non-cached reads are a bit slower</li>
</ul>
</li>
<li>write-around - write requests are pushed into DB, data cached only after a number of read requests
<ul>
<li>frequently accessed data is prioritized</li>
</ul>
</li>
<li>write-back - write requests are stored inside cache and unloaded into DB once per some amount OR time period
<ul>
<li>writes optimized</li>
</ul>
</li>
</ul>
<h6 id="implementations">Implementations</h6>
<ul>
<li>in-memory - often via some libs or structures, like <code dir="auto">Map</code></li>
<li>redis - robust, stand alone, in-memory cache</li>
<li>memcached</li>
<li>AWS Elasticache</li>
<li>GCP Memorystore</li>
</ul>
<h6 id="use-cases">Use-Cases</h6>
<ul>
<li>storing user sessions</li>
<li>reduce overhead of microservice communication</li>
<li>caching frequent DB operations (reads OR writes)</li>
</ul>
<h6 id="invalidation-strategies">Invalidation strategies</h6>
<ul>
<li>time based - invalidate after some time
<ul>
<li>types:
<ul>
<li>time to live (TTL) - each data has some time, that it can live, after been cached, after which it will be refetched, if accessed again</li>
</ul>
</li>
<li>great for tokens</li>
</ul>
</li>
<li>event based - invalidate after some event occurs
<ul>
<li>types:
<ul>
<li>purge - remove cache</li>
<li>refresh - invalidate cache and request new one</li>
<li>ban - remove cache and stop caching</li>
<li>stale-while-revalidate - serve cached versions, then update
<ul>
<li>often used in CDNs</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="cache-eviction">Cache eviction</h6>
<p>Cache size is limited, so we need some method to make a room for new one, by efficiently removing other</p>
<ul>
<li>Least Recently Used (LRU) - remove last used data
<ul>
<li>web pages in browser</li>
</ul>
</li>
<li>Least Frequently User (LFU) - sort data by frequency and remove one at the bottom
<ul>
<li>search engine queries</li>
</ul>
</li>
<li>First in First out (FIFO) - remove data in order it was cached, similar to Queue
<ul>
<li>messages in messaging app</li>
</ul>
</li>
<li>Most Recently Used (MRU) - remove first used data</li>
<li>Random Replacement (RR) - remove random data
<ul>
<li>data set with no priority between items, like assets in game</li>
</ul>
</li>
<li>Least Used - globally sort data by frequency and remove OR avoid caching ones at the bottom</li>
<li>On-Demand Expiration - cache can be freed only manually
<ul>
<li>the case, when managing in-memory cache in languages like C++</li>
</ul>
</li>
<li>Garbage Collection - cache freed automatically
<ul>
<li>the case, when managing in-memory cache in languages like C++</li>
</ul>
</li>
</ul>
<h6 id="common-problems">Common problems</h6>
<p>thundering herd problem - multiple cached items expired, thus all requests will miss and overload the system</p>
<ul>
<li>solution: warm cache in periods of in-activity</li>
</ul>
<p>cache penetration - user DDOS service with non-existent data, thus preventing any cache hits and overloading the system</p>
<ul>
<li>solution: input validation, rate limiting of request</li>
</ul>
<p>cache breakdown - cache breaks, thus all requests will miss and overload the system</p>
<ul>
<li>solution: implement failover and auto-recovery mechanisms, introduce health checks and system monitoring</li>
</ul>
<p>stale cache - cache data is invalid, thus system operates on improper data</p>
<ul>
<li>solution: add logging to catch this issues, use stable technologies and patterns to avoid caching problems</li>
</ul>
<h2 id="other-concepts">Other concepts</h2>
<h4 id="single-sign-on-sso">Single Sign-On (SSO)</h4>
<p>Tech that allows for user to sign once and access all parts of the system after it</p>
<ul>
<li>as benefit for devs, removes need to create separate authN flows per each app</li>
</ul>
<p>can be detected by redirect to separate login page</p>
<p>implementation strategies:</p>
<ul>
<li>sub-domain + cookies - straightforward way, done by hosting all apps under single domain, thus allowing all of them to share cookies
<ul>
<li>benefits: easy to implement</li>
<li>problems: limited by sub-domain, specific implementations will arrive on each consumer, depending on their technologies</li>
</ul>
</li>
<li>separate auth service - create service that will be a single source of authN&#x26;authR truth
<ul>
<li>implementation notes:
<ul>
<li>based on token model(access + refresh), where token can be in JWT or some other hash format
<ul>
<li>such token contains all info about user and can grant full or partial permission to system</li>
<li>JWT (JSON Web Token) - format of encoding JSON into Base64 to transfer through net</li>
</ul>
</li>
</ul>
</li>
<li>benefits: cross-platform, one service handles all user &#x26; auth management, broadly adopted standard, user permissions can be granted partially(it can also depend on application, you logged in)</li>
<li>problems: it is hard to recover lost token so additional safety measures need to be implemented</li>
</ul>
</li>
</ul>
<h4 id="db-design">DB Design</h4>
<h6 id="sqlrelational-db-vs-nosqlnon-relational-db">SQL(relational DB) vs NoSQL(non relational DB)</h6>
<p>Crucial point in DB design, is choosing what type of DB you need, based on your requirements and needs</p>
<p>SQL - focus on data with relations and column+row mental model</p>
<ul>
<li>have predefined schema</li>
<li>can be scaled vertically and horizontally</li>
<li>can be partitioned vertically and horizontally</li>
<li>stores data in form of a table, with primary and foreign keys</li>
<li>great for structured data, complex data, transactional data</li>
<li>design is rigid, SO any change will require migration</li>
<li>examples: PostgreSQL, MySQL</li>
</ul>
<p>NoSQL - focus on flexible and dynamic data, with loose relations</p>
<ul>
<li>schema and types are dynamic</li>
<li>can be scaled vertically and horizontally</li>
<li>can be partitioned only horizontally</li>
<li>stores data in format of a: document, key-val, graph; basically we can choose the most suitable format for data</li>
<li>great for data like: documents, JSON</li>
<li>can be easily scaled-up OR down</li>
<li>data can’t be accessed in complex manner AND data normalization may be needed
<ul>
<li>this leads to different syntax per DB</li>
<li>no need for complex migrations, structure can be changed with ease</li>
</ul>
</li>
<li>can be great starting point, where requirements are loose and you need to change fast</li>
<li>examples: MongoDB, Casandra, Redis</li>
</ul>
<h6 id="db-indexing">DB indexing</h6>
<p>In general, index is a way to point to some information</p>
<ul>
<li>DB index have similar function and enabled faster read queries, because engine don’t need to scan full DB to find something, it can do scanning, based on indexes
<ul>
<li>it acts as sort of metadata</li>
</ul>
</li>
</ul>
<p>types:</p>
<ul>
<li>clustered index - acts as primary keys for indexing
<ul>
<li>changes order of data in DB
<ul>
<li>data will can be stored as Balanced Binary Tree, thus enabling direct Binary Search on data</li>
</ul>
</li>
<li>can be only one per table</li>
</ul>
</li>
<li>non clustered index - acts as additional/secondary index
<ul>
<li>doesn’t affect original data, BUT requires additional table to be stored, where it stores index + pointer to data location
<ul>
<li>additional table can be stored as Balanced Binary Tree, thus enabling Binary Search on this metadata to find reference/pointer to original data</li>
</ul>
</li>
<li>can be several per table</li>
<li>it is recommended to add indexes for most commonly used columns, when:
<ul>
<li>filtering (<code dir="auto">WHERE</code>)</li>
<li>sorting (<code dir="auto">ORDER BY</code>)</li>
<li>grouping (<code dir="auto">GROUP BY</code>)</li>
<li>joining (<code dir="auto">JOIN</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>problems:</p>
<ul>
<li>data modification queries are slower, because sync of indexing is required</li>
</ul>
<p>alternatives to BBT:</p>
<ul>
<li>hash (don’t requires balancing, but won’t work for range quires)</li>
<li>bitmap (great for read-heavy operations with small number of possible values)</li>
</ul>
<p>sparse indexes - refer to partial data storage, meaning we index only some chunk of data</p>
<h4 id="proxy">Proxy</h4>
<h6 id="forward-proxy-vs-reverse-proxy">Forward Proxy vs Reverse Proxy</h6>
<p>Both proxies are important types and have distinct roles, main different comes from level of network operation</p>
<p>forward proxy - interface that client uses to interact with system</p>
<ul>
<li>use-cases: client anonymity(change client’s IP to proxy’s), caching, traffic control, logging, request/response transformation, authN&#x26;authR</li>
</ul>
<p>reverse proxy - facade for single/multiple servers</p>
<ul>
<li>use-cases: server anonymity, caching, load balancing, DDOS protection, canary, request/response transformation, encryption/SSL management(offload servers)</li>
<li>examples: Nginx</li>
</ul>
<h4 id="serverless">Serverless</h4>
<p>Model of building backend, where all responsibility for managing server(env and machine) is offloaded to provider, so there is only need to write application code, that will execute logic and interact with simple APIs, from provider</p>
<ul>
<li>it is similar to Infra as a Service modal, BUT here you don’t need to do any management of infra at all
<ul>
<li>also you pay per request AND NOT per machine</li>
</ul>
</li>
</ul>
<p>types:</p>
<ul>
<li>function as service - execute specific function in isolation</li>
<li>backed as service - execute entire application</li>
</ul>
<p>use-cases(often short lived tasks):</p>
<ul>
<li>API integrations</li>
<li>trigger based actions
<ul>
<li>schedulers</li>
<li>notification sender</li>
<li>webhooks</li>
</ul>
</li>
<li>automations</li>
<li>data-processing</li>
<li>backends (with low load on it)</li>
</ul>
<p>benefits:</p>
<ul>
<li>auto-scaling, load balancing and other benefits are already done
<ul>
<li>no need to manage any server infra, thus faster dev time</li>
</ul>
</li>
<li>pay per request</li>
<li>language agnostic</li>
</ul>
<p>disadvantages:</p>
<ul>
<li>you will go broke as your traffic grows ;)</li>
<li>can’t execute for too long</li>
<li>additional delay to spin-up</li>
<li>vendor-lock</li>
</ul>
<h4 id="authentication">Authentication</h4>
<p>Authentication can be done in different ways, where each way have some use-case, specific benefits and constraints</p>
<h6 id="jwt-json-web-token">JWT (JSON Web Token)</h6>
<p>JWT is way to encode JSON into binary format, so it can be easily transported</p>
<ul>
<li>it is not authentication technique by itself, BUT can be used to identify users in authN flow</li>
<li>additional public/private encryption and/or hashing can be added for safety</li>
<li>includes: expiration data, user info, issuer and additional metadata</li>
<li>flow:
<ul>
<li>client provides credentials</li>
<li>server creates JWT, stores and return it to client</li>
<li>client saves it somewhere(commonly in cookie OR in-memory)</li>
<li>client adds token as part of request(usually as some dedicated header), so server can receive+verify token and proceed with request</li>
</ul>
</li>
<li>additionally:
<ul>
<li>it is possible to have several tokens, for better UX
<ul>
<li>session token - works as described above</li>
<li>refresh token - used to generate new session token, without need to provide credentials</li>
</ul>
</li>
</ul>
</li>
<li>note: authR is managed separately and not a part of JWT</li>
</ul>
<h6 id="oauth">OAuth</h6>
<p>It is a protocol, that enables authN &#x26; authR via/with third-party service(identity-provider)</p>
<ul>
<li>use-cases:
<ul>
<li>give granular access for third-party to your service
<ul>
<li>ex: allow service to edit user’s GoogleCalendar</li>
</ul>
</li>
<li>authenticate user into your service, based on data from identity-provider
<ul>
<li>ex: Sign-in with Google</li>
<li>this requires usage of OpenID Connect protocol</li>
<li>for successful login identity-provider returns token, that can identify user in service</li>
</ul>
</li>
</ul>
</li>
<li>alternative: Federated Credential Management(FedCM) browser API</li>
</ul>
<h6 id="saml-security-assertion-markup-language">SAML (Security Assertion Markup Language)</h6>
<p>XML-based standard of exchanging authN &#x26; authR data between parties</p>
<ul>
<li>flow:
<ul>
<li>client provides credentials</li>
<li>server creates SAML assertion in XML format</li>
<li>client can re-use this assertion to authorize requests from itself</li>
</ul>
</li>
<li>common use-case: SSO</li>
</ul>
<h4 id="related-algorithms-and-data-structures">Related Algorithms and Data Structures</h4>
<p>Consistent hashing - algorithm to evenly distribute data between multiple nodes</p>
<ul>
<li>implementation: for each node assign range of hashes, hash each data and assign it to node that covers value in it’s range
<ul>
<li>additionally, it is possible to assign data and ranges to virtual nodes AND assign several virtual node to physical one, thus making down/up-scaling and data transfer easier</li>
</ul>
</li>
<li>use-case: DB partitioning</li>
</ul>
<p>MapReduce - algorithm for processing large data sets in parallel, thus making it faster and reliable</p>
<ul>
<li>implementation is broken into several steps:
<ul>
<li>break all data into smaller chunks</li>
<li>map each chunk in parallel (result is often some key-value pairs)</li>
<li>merge and sort all chunks together</li>
<li>reduce result, so all keys are merged into one and each value is included in final result (ex: each value is summed, multiplied etc)</li>
</ul>
</li>
</ul>
<p>Distributed hash tables (DHT) - way to store data in key-value manner, so each pear of network can hold only part of data, thus systems becomes faster, easier to scale and more resilient in self-organization manner</p>
<ul>
<li>allows to locate value by only querying small number of participant
<ul>
<li>enabled by proper distribution algorithm</li>
</ul>
</li>
<li>use-cases: p2p networks, CDN, distributed DB</li>
</ul>
<p>Bloom filters - algorithm to efficiently detect if data is present in some set, by hashing and using bit map arrays</p>
<ul>
<li>can produce false-positive results, BUT with proper number of hashes and size of bit array, this rate is quite low, so can be tolerated, for large data-sets</li>
</ul>
<p>Two-phase commit - algorithm to ensure consistent transactions in distributed systems</p>
<ul>
<li>flow:
<ul>
<li>coordinator asks all nodes if they can commit
<ul>
<li>if any answer is missing or “no”, operation is aborted</li>
<li>if all answers are yes, operation proceeded</li>
</ul>
</li>
<li>coordinator asks all nodes to commit</li>
<li>each node commits and sends status
<ul>
<li>if any answer is missing or “failure”, coordinator asks all nodes to rollback</li>
<li>if all answers are “success”, coordinator informs all nodes that operation is successful</li>
</ul>
</li>
</ul>
</li>
<li>problems:
<ul>
<li>higher latency</li>
<li>single pointe of failure</li>
<li>dead-lock</li>
</ul>
</li>
</ul>
<p>Paxos - algorithm to ensure consistent values in distributed systems, with failure tolerance</p>
<ul>
<li>flow:
<ul>
<li>coordinator asks all nodes to remember some value
<ul>
<li>if majority answered - operation proceeded, else - aborted</li>
</ul>
</li>
<li>coordinator asks all nodes to accept some value
<ul>
<li>if majority accepted - value accepted</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Raft - algorithm to ensure consistent stream of values in distributed systems, with failure tolerance</p>
<ul>
<li>flow:
<ul>
<li>group of nodes elect the leader</li>
<li>leader accepts the data and passed it to all nodes
<ul>
<li>node can request data from leader too</li>
</ul>
</li>
<li>if leader fails, re-election happens</li>
</ul>
</li>
</ul>
<p>Gossip - efficient algorithm to share data in p2p systems, with high failure tolerance</p>
<ul>
<li>all data is transferred from node to it’s closest neighbours, thus populating network
<ul>
<li>it can be transferred on demand (pull) OR when new data arrives (push)</li>
</ul>
</li>
</ul>
<p>CAP theorem - theorem, that states, that distributed system can’t achieve all characteristics simultaneously</p>
<ul>
<li>consistency - all nodes have same and up-to-date info</li>
<li>availability - system is always responds</li>
<li>tolerance - system is responds, even if part of it dies</li>
</ul>
<h4 id="encryption">Encryption</h4>
<h6 id="symmetric-encryption">Symmetric Encryption</h6>
<p>Method of using single key to encrypt/decrypt data</p>
<ul>
<li>this key can be viewed as a password, that need to be known by two sides beforehand AND can be shared at any point</li>
</ul>
<h6 id="asymmetric-encryption">Asymmetric Encryption</h6>
<p>Method of using pair of keys to encrypt/decrypt data</p>
<ul>
<li>public key - used to encrypt data, can be shared</li>
<li>private key - used to decrypt data, stays with party, that created pair</li>
</ul>
<h6 id="e2e-encryption">E2E Encryption</h6>
<p>Method that encrypts data, to prevent any access to it, when it is transferred from one user to other</p>
<ul>
<li>it is encrypted on one side and can only be decrypted on other side</li>
</ul>
<p>how it is done:</p>
<ul>
<li>based on asymmetric encryption</li>
<li>uses insurance system, that prevents man in the middle problem
<ul>
<li>insurance is done via legitimate third-party authority, that embeds keys into certificates</li>
</ul>
</li>
</ul>
<h6 id="transit-encryption">Transit Encryption</h6>
<p>Method that encrypts data, to prevent any access to it, when it is transferred, but overall systems includes middle man, that encrypt/decrypt data, before sending it to users</p>
<p>how it is done:</p>
<ul>
<li>based on asymmetric encryption</li>
<li>uses insurance system, that prevents man in the middle problem
<ul>
<li>insurance is done via legitimate third-party authority, that embeds keys into certificates</li>
</ul>
</li>
</ul>
<h4 id="technologies">Technologies</h4>
<h6 id="redis">Redis</h6>
<p>Redis is remote, in-memory NoSQL key-value storage, that is used as cache or lightweight and fast DB</p>
<ul>
<li>main goal is to reduce bottleneck of slow operations with DB or disks, by handling data in-memory</li>
</ul>
<p>possibilities:</p>
<ul>
<li>in-memory cache</li>
<li>queuing</li>
<li>multiple data-types</li>
<li>Sentinel - separate system, that used to manage distributed system of Redis instances for resource optimization and sharing</li>
<li>Pub/Sub - separate system, that enables Streaming</li>
<li>persistence - enables taking snapshots of data in memory and dumping them on disk</li>
</ul>
<p>vs Memcached:</p>
<ul>
<li>benefits:
<ul>
<li>allows for more data-types</li>
<li>enables more fine-tuning of cache</li>
</ul>
</li>
<li>problems: higher complexity</li>
</ul>
<p>use-cases</p>
<ul>
<li>DB caching</li>
<li>real-time analytics</li>
<li>location-based applications</li>
</ul>
<h6 id="kafka">Kafka</h6>
<p>Kafka is used for decoupling data source from target system by acting as intermediate layer, that stores and enables data consuming</p>
<p>problems it solves:</p>
<ul>
<li>unify data formats</li>
<li>unify transfer protocols</li>
<li>reduce complexity, make system more maintainable and resilient</li>
<li>allows handling high number of connections</li>
</ul>
<p>specs:</p>
<ul>
<li>open source</li>
<li>used as framework for storing, reading and analyzing data streams</li>
<li>build to be horizontally scalable</li>
</ul>
<p>use-cases:</p>
<ul>
<li>messaging - activity tracking — (working with streams)</li>
<li>gather metrics, logs or any data from multiple sources</li>
<li>stream operations</li>
<li>big data</li>
</ul>
<p>concepts:</p>
<ul>
<li>topic - temporal data storage</li>
<li>partitions - each topic can be configured to be auto partitioned</li>
<li>offset - ID, assigned per message, that relevant in scope of partition
<ul>
<li>each message can be found with <code dir="auto">topic+partition+offset</code></li>
</ul>
</li>
<li>broker - separate servers, that store partitions
<ul>
<li>group of brokers == cluster</li>
</ul>
</li>
<li>replication - kafka can be configured to auto-replicate data to a given number of times
<ul>
<li>separate partitions are replicated</li>
<li>replicas will always be stored in other brokers</li>
<li>replication is done via leader system, basically kafka has one leader, that performs read+write operations AND followers, that sync themselves with leader AND can become leader if original leader is failed</li>
</ul>
</li>
<li>producer - kafka uses load-balancers, called producers, that perform writes to leader partition
<ul>
<li>all data is pushed to end of the topic</li>
<li>algorithm: locate all brokers with leader partitions, choose the least loaded one, append data
<ul>
<li>it is possible to provide key, that will be used to choose partition manually
<ul>
<li>note: same key will always result in same partition</li>
</ul>
</li>
</ul>
</li>
<li>data can be synced in this way(each has different risk of data loss):
<ul>
<li>no acknowledgment - producer pushes data without waiting for any response</li>
<li>1-acknowledgment - producer pushes data with waiting for leader response</li>
<li>n-acknowledgment - producer pushes data with waiting for leader and n-1 replicas response</li>
</ul>
</li>
</ul>
</li>
<li>consumer - kafka uses load-balanced consumers, that read data from leader partition
<ul>
<li>for better performance, consumers are packed in consumer groups, and read only portion of data from topic each(1 consumer per 1 partition)</li>
<li>kafka maintain consumer offset - int number that points to last read data, so consumer won’t return duplicates</li>
<li>consuming stratagies:
<ul>
<li>at most once - message better be lost, than duplicated
<ul>
<li>offset is changed after message is received, rather then processed</li>
</ul>
</li>
<li>at least once - message can’t be lost, but can be duplicated
<ul>
<li>offset is changed after message is processed</li>
<li>application must be idempotent</li>
</ul>
</li>
<li>exactly once - message can’t be lost and can’t be duplicated
<ul>
<li>achieved via kafka-2-kafka streaming</li>
</ul>
</li>
</ul>
</li>
<li>consumer connects to 1 broker first, receives info about cluster, connects to other brokers(if needed)</li>
</ul>
</li>
<li>zookeeper - core software, that used to manage distributed system under the hood of kafka</li>
</ul>
<h6 id="rabbitmq">RabbitMQ</h6>
<p>For more robust and efficient service-to-service communications we can use Message Based communication, where each service interacts through a MessageBroker mediator</p>
<ul>
<li>improves speed</li>
<li>reduces coupling of services</li>
<li>allows for load-balancing messages to consumers</li>
</ul>
<p>RabbitMQ is open-source MessageBroker</p>
<ul>
<li>most popular way of using is with Advanced Message Queuing Protocol, that sends data in frames in custom binary format</li>
</ul>
<p>Concepts:</p>
<ul>
<li>producer - writer to MessageBroker</li>
<li>consumer - reader from MessageBroker</li>
<li>queue - intermediate storage for messages</li>
<li>connection - RabbitMQ allows for TCP connections to it
<ul>
<li>RabbitMQ establishes single connection, BUT it splits it into channels and uses them to send data</li>
</ul>
</li>
<li>exchange - receives messages from producer and pushes them to 0-n queues
<ul>
<li>exchange configured via rules, called bindings</li>
<li>exchange do routing based on binding AND received route-keys(addresses)</li>
<li>types:
<ul>
<li>direct - route to queue, by provided key</li>
<li>fanout - route to all queues, specified in binding</li>
<li>topic - do wildcard match between binding and key</li>
<li>header - route by data in message’s header</li>
</ul>
</li>
</ul>
</li>
<li>users - each instance of RabbitMQ includes authN and authR built-in
<ul>
<li>each instance can be broken into virtual once</li>
</ul>
</li>
<li>acknowledgements - rabbit allows for loss free transfer via acknowledgement system(from consumer OR from exchange)
<ul>
<li>acknowledgements can be batched</li>
</ul>
</li>
<li>prefetching - rabbit allows to set sliding window, of how many messages can be sent over one channel, before acknowledgement is received
<ul>
<li>too high will cause overflow, too low will slow down transfers</li>
</ul>
</li>
</ul>
<p>best practices:</p>
<ul>
<li>keep queue size limited
<ul>
<li>too large queue results in high RAM</li>
<li>RabbitMQ has preserving RAM mechanism of flushes to the disk, BUT it will degrade performance</li>
<li>how-to:
<ul>
<li>limit queue size OR add TTL
<ul>
<li>results in messages loss</li>
</ul>
</li>
<li>make acknowledgements fast
<ul>
<li>they can be done in async manner, BUT it will result in messages loss</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>multiplex TCP + limit TCP connections</li>
<li>keep connections long lived</li>
<li>if loss isn’t and option, don’t limit queue AND enforce acknowledgements</li>
<li>isolate consumer and producer with different connections, if done in single app</li>
</ul>
<h6 id="aws-elasticsearch">AWS Elasticsearch</h6>
<p>Service for large handling operations on large data, such as searching, analytics etc</p>
<ul>
<li>can be self-hosted OR bought via AWS</li>
<li>great for searching for data AND meta-data</li>
</ul>
<p>In it’s core Elasticsearch works on top of large number of shards(small isolated DBs), and creates a facade with simple interface to query and operate upon those shards</p>
<ul>
<li>collection of relevant shards is an index</li>
<li>upon facade it introduces replication mechanism</li>
<li>highly performant, because utilizes indexes</li>
<li>could be used as single source of truth</li>
<li>have large number of data-types</li>
</ul>
<h6 id="docker">Docker</h6>
<p>Docker is software, that used to distribute other software</p>
<ul>
<li>based on containers, where each container is self-contained piece, that provides environment to execute anything inside of it
<ul>
<li>characteristics: light-weight, flexible in customization, standardized(allows for ease shipping), self-contained(ease of deployment)</li>
<li>main focus is to isolate piece of software and it’s dependencies, so it can consistently be ran in any env</li>
</ul>
</li>
<li>based in concept of Virtual Machine, which means some isolated environment, that simulates anythings needed and can be ran on shared physical hardware with other VMs or even full OS
<ul>
<li>done by creating isolated instances of custom software + OS inside of it, putting them into actual machine, that has light-weight OS and hypervisor, which is used for monitoring, logging, managing resources, action taking etc</li>
<li>plain VM is slow, because it needs separate full OS and vendor locked, because it is dependent on hypervisor</li>
</ul>
</li>
</ul>
<p>Docker combines VM and container approach, such as:</p>
<ul>
<li>each container has all needed code and dependencies</li>
<li>software dependency is covered by using host’s OS
<ul>
<li>Container engine allows hooking into OS with minimal risk</li>
</ul>
</li>
<li>concepts:
<ul>
<li>Dockerfile - config with instructions to build DockerImage</li>
<li>DockerImage - template, that contains everything needed and can be replicated into any number of DockerContainers
<ul>
<li>each image is immutable</li>
</ul>
</li>
<li>DockerContainer - isolated container, that can be ran via DockerEngine</li>
</ul>
</li>
</ul>
<p>optimization tricks:</p>
<ul>
<li>cache is linear, so keep highly changing parts at the end of a Dockerfile</li>
<li>aim to execute building steps for libs once and cache the result</li>
</ul>
<h6 id="kubernetes">Kubernetes</h6>
<p>System, that built upon docker and used to manage large number of docker containers in configuration+automation manner</p>
<p>possibilities:</p>
<ul>
<li>ensure resilience, by re-starting failed container (failover)
<ul>
<li>also includes health-checks</li>
</ul>
</li>
<li>scale containers up/down
<ul>
<li>horizontal AND vertical</li>
</ul>
</li>
<li>deploy large number of containers with some deployment patterns</li>
<li>automatic rollouts and rollbacks</li>
<li>hosting container
<ul>
<li>load-balancing is included</li>
</ul>
</li>
<li>environment, secrets management</li>
</ul>
<h4 id="12-factors-of-scalable-service">12 factors of scalable service</h4>
<ul>
<li>general requirements:
<ul>
<li>building, starting etc of an app is done in declarative manner</li>
<li>app is environment agnostic as much as possible</li>
<li>app can be deployed in fast and continues manner</li>
<li>app can be scaled without additional configurations</li>
<li>grows of an app should be organic</li>
<li>DX must be good</li>
</ul>
</li>
</ul>
<h6 id="factors">Factors</h6>
<ol>
<li>Codebase
<ol>
<li>all changes are tracked via VersionControl system</li>
<li>notes:
<ol>
<li>1 codebase == 1 app</li>
<li>several codebases == several apps (can be a distributed system)</li>
<li>shared code should be factored to libs and used as dependency, NOT directly</li>
<li>1 app can have many deployments: prod, env(s), local
<ol>
<li>deployments can be different version of an app</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>Dependencies
<ol>
<li>all dependencies need to be explicit and isolated</li>
<li>implementations: system-wide, bundled into the app
<ol>
<li>for dependency to be explicit and isolated it must be stated in some config/manifesto AND bundled into the app
<ol>
<li>makes app easy to share AND all deployments uniform</li>
</ol>
</li>
<li>package managers are common tool for dependency management</li>
</ol>
</li>
<li>any “common” dependencies like curl should be bundled too, to be env agnostic</li>
</ol>
</li>
<li>Config
<ol>
<li>config must be a part of the environment
<ol>
<li>it can be accessed by an app from env OR it can be backed-in on the build step (if build is done in the env)</li>
<li>it can’t be in the code, because it makes code differ per env</li>
</ol>
</li>
<li>config is one of few parts that differ between each deployments</li>
<li>config includes:
<ol>
<li>addresses to connect to shared resources</li>
<li>credentials</li>
<li>environment specific knowledge, like: hostname etc</li>
</ol>
</li>
<li>main goal is to make possible to open-source code and not leak any credentials
<ol>
<li>this implies usage of standard processes, like <code dir="auto">.env</code> or similar systems, that prevent accidental leakage of credentials</li>
</ol>
</li>
<li>grouping configs will make scaling harder
<ol>
<li>better way is to view each env as a thing on itself, that can be granularly controlled</li>
</ol>
</li>
</ol>
</li>
<li>Backing Services
<ol>
<li>services can be
<ol>
<li>local - hosted on same machine</li>
<li>external - hosted over the net, on different machine</li>
</ol>
</li>
<li>any dependency in form of service(DB, third-party API, queue service, email service etc) should be tread as external, to keep any dependency easily swappable
<ol>
<li>swap should be possible only by re-configuring envs</li>
</ol>
</li>
</ol>
</li>
<li>Build, release, run
<ol>
<li>separate each stage of this process</li>
<li>build - transform written code into executable, by merging-in dependencies, optimizing, compiling etc
<ol>
<li>done by developers</li>
</ol>
</li>
<li>release - combine builded version and envs, with possible movement of code from machine to machine
<ol>
<li>done by developers</li>
</ol>
</li>
<li>run - execute released version
<ol>
<li>done automatically</li>
</ol>
</li>
<li>benefits:
<ol>
<li>separation of concerns</li>
<li>impossibility to un-build program, that is running</li>
<li>possibility to re-use some step
<ol>
<li>ex: make several runs from one example, create multiple releases from build</li>
</ol>
</li>
<li>possibility to rollback
<ol>
<li>to do this you must: label each release with id/timestamp, keep all releases immutable</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>Processes
<ol>
<li>each instance of an app must be stateless</li>
<li>all data must be stored in separate shared backing service</li>
<li>any local state must be short lived
<ol>
<li>ex: cache, intermediate values of operation</li>
<li>reason: second request might be routed to separate process, process might fail, process might be re-ran</li>
</ol>
</li>
</ol>
</li>
<li>Port binding
<ol>
<li>all access to the app must be done via dedicated, opened port, by HTTP(S) or similar protocol
<ol>
<li>the point is to make app easily accessible via single entrance point</li>
</ol>
</li>
<li>this allows to use app as Backing Service or directly asses it</li>
</ol>
</li>
<li>Concurrency
<ol>
<li>scaling should be done via process model, where we have process formation, that tells us what types of processes do we have(ex: HTTP request handler, background task etc) and how much of each type we are running</li>
<li>this way we can easily extract some process type into own machine OR reliably expand functionality</li>
<li>process management should be done via standard APIs</li>
</ol>
</li>
<li>Disposability
<ol>
<li>keep startup-ups fast and shutdowns graceful</li>
<li>benefits:
<ol>
<li>any changes can be deployed fast</li>
<li>failed deployments can be re-deployed</li>
<li>service can be scaled in both directions easily</li>
<li>system can auto-scale</li>
<li>system is more reliable</li>
</ol>
</li>
<li>notes:
<ol>
<li>for web-sockets of long-polling seamless re-connect mechanism must be implemented on client OTHER requests must be short-lived</li>
<li>for queue systems any unprocessed operations should be returned to queue</li>
<li>for lock-based systems locks must be released</li>
<li>incorporate sudden failure handlers to make unexpected shutdowns graceful-ish</li>
</ol>
</li>
</ol>
</li>
<li>Dev/Prod parity
<ol>
<li>keep dev and prod as similar as possible</li>
<li>distinctions come from:
<ol>
<li>time - feature is developed locally for too long
<ol>
<li>use trunk based development</li>
</ol>
</li>
<li>personnel - deployment is done via DevOps team
<ol>
<li>incorporate CI/CD</li>
<li>developer need to verify that production is working and <code dir="auto">main</code> is stable</li>
</ol>
</li>
<li>tools - different tools locally and on prod
<ol>
<li>bundle dependencies into an app OR make it easy to run light-weight variation of dependence outside of an app OR expose environment dependencies for local use
<ol>
<li>docker is often a great solution</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>Logs
<ol>
<li>logging is important for monitoring</li>
<li>logs should be treated as stream of aggregated, time-ordered events
<ol>
<li>logs can’t have beginning/end and often represented as txt with 1 log per line</li>
</ol>
</li>
<li>logs must be collected from each process and backing service</li>
<li>app don’t need to know about logs
<ol>
<li>general approach is to dump logs to <code dir="auto">stdout</code> and make environment collect them to file, dump this files to some external storage etc
<ol>
<li>for local runs it is enough for dev to just see <code dir="auto">stdout</code></li>
<li>external storage can be just archive OR some big-data service, that will allow to view trends, find specific events and add altering system, that will react to anomalies in logs</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li>Admin process
<ol>
<li>it must be possible to do admin/management activities directly on prod
<ol>
<li>ex: run scripts(ex: db migration), interact with live console</li>
</ol>
</li>
<li>scripts should be shipped directly with app’s code and can be treated as dependency</li>
<li>direct access can be done with tools like SSH</li>
</ol>
</li>
</ol>
<h4 id="synchronization-methods">Synchronization Methods</h4>
<p>In system, where multiple operations can be done simultaneously, synchronization must be introduced</p>
<h6 id="mutex">Mutex</h6>
<p>Mutex is locking mechanisms, that provides ownership over some operation to single executor</p>
<p>Common principle, is to have moderator(mutex object), that can be locked and “held” by some party, until task executes. Other parties will wait, until mutex is locked. After one party finishes operation unlock call is executed and next in line can acquire mutex</p>
<ul>
<li>
<p>use-cases:</p>
<ul>
<li>locking resource usage (data integrity)</li>
<li>locking operation execution (no race conditions)</li>
</ul>
</li>
<li>
<p>potential problems:</p>
<ul>
<li>some queueing should be held by mutex object, to avoid keeping one party waiting for too long
<ul>
<li>prioritization can be added, to make higher-priority threads go first</li>
<li>it can drain CPU</li>
</ul>
</li>
<li>if mutex wasn’t released, because process died, mutex won’t unlock and drain resources</li>
</ul>
</li>
</ul>
<p>how to deadlock yourself:</p>
<ul>
<li>make thread wait for release, when he is who one holds</li>
</ul>
<h6 id="semaphore">Semaphore</h6>
<p>Mechanism of coordination between multiple threads, that based thread-thread communication, without strict ownership</p>
<p>common principle is to have shared int value(>=0), that signifies how much threads can be used in a pool to operate on data. Each thread can Wait until value is >0, acquire slot by reducing value, do operation, increase value to release slot</p>
<ul>
<li>
<p>pool manager need to give access to chunks of data per thread, to avoid sharing</p>
</li>
<li>
<p>benefits:</p>
<ul>
<li>multiple threads can work on shared resources</li>
<li>flexible resource management</li>
</ul>
</li>
</ul>
<p>problems:</p>
<ul>
<li>risk of deadlock</li>
<li>prioritization problem by default</li>
<li>no modularity</li>
</ul>
<h4 id="blob-storage">Blob Storage</h4>
<p>Blob storage is a type of storage, that is design to hold large amount of unstructured Blobs(Binary Large Object), that is basically data in any format, where each blob can be whole file(classical approach) OR part of file, that can be aggregated into whole file on demand</p>
<p>characteristics:</p>
<ul>
<li>has no structure</li>
<li>should be scalable and have large capacity</li>
<li>connectivity:
<ul>
<li>via API for developers</li>
<li>via CDN for users</li>
</ul>
</li>
<li>types:
<ul>
<li>hot - fast access, hight price (often based on SSD)</li>
<li>cold - slow access, low price (often based on HDD)</li>
</ul>
</li>
<li>data management:
<ul>
<li>can include policies to evict data</li>
<li>can have access managements</li>
<li>can append metadata per blob</li>
</ul>
</li>
</ul>
<p>vs other solutions:</p>
<ul>
<li>file storage - has no structure OR hierarchy + doesn’t operate with “file” abstraction + uses bucket abstraction to store data</li>
<li>block storage - designed as read-first + doesn’t support fast random access operations</li>
</ul>
<p>common use-cases: file storage, log storage, CDN, media hosting, archiving</p>
<h4 id="block-storage">Block Storage</h4>
<p>Block Storage is a type of storage, where data is broken and stored in fixed-size chunks(aka blocks), where each block has fixed address, so it is easily accessible</p>
<p>properties:</p>
<ul>
<li>data can be located easily, BUT has no structure as is</li>
<li>no metadata is allowed</li>
</ul>
<p>use-cases: OS, VM, DB, I/O heavy apps</p>
<h4 id="m3u-files">M3U Files</h4>
<p>M3U is file format, that defines what version of video OR audio do you have, so browser can look at it first, determine what version will be most sufficient to user(network, browser version, OS etc) and request specific media</p>
<h4 id="recommendation-algorithm">Recommendation Algorithm</h4>
<p>types:</p>
<ul>
<li>query based</li>
<li>user + item properties match</li>
<li>---</li>
<li>often they used hand-in-hand, by first filtering by query AND then sorting via match score</li>
</ul>
<p>building an algorithm:</p>
<ul>
<li>divide into two modules:
<ul>
<li>matcher - reduce initial data-set to what user might like</li>
<li>ranker - rank reduced data-set</li>
</ul>
</li>
<li>non-functional requirements:
<ul>
<li>large data-set: item data, user data, user-item interactions
<ul>
<li>interactions can be collected in form of: user events(clicks etc), user actions(buy, like, comment etc)</li>
</ul>
</li>
<li>possibility to hot swap ML algorithm AND measure</li>
<li>performance, auto-scaling etc</li>
<li>offline training of ML algorithms via some data pipeline</li>
</ul>
</li>
</ul>
<h2 id="designing-distributed-systems">Designing Distributed Systems</h2>
<p>Set of patterns and advices to make distributed systems efficient AND reliable</p>
<ul>
<li>this patterns aim to make development predictable and understandable, turning it from art to science
<ul>
<li>basically, stop re-inventing the wheel each time</li>
</ul>
</li>
<li>all patterns are heavily based on Container pattern</li>
</ul>
<h4 id="intro">Intro</h4>
<p>Most of apps need to scale rapidly AND be reliable, thus there is only one way…build it distributed</p>
<h6 id="history">History</h6>
<p>Single purpose machines -> multi purpose, one task machines -> multi purpose, multi task machines -> network of multi purpose, multi task machines (client-server architecture) -> large network with single purpose (distributed system)</p>
<p>benefits of DS:</p>
<ul>
<li>resilience</li>
<li>scalability</li>
<li>easy to maintain(large organization with small teams, that own each MicroService independently)
problems:</li>
<li>cost</li>
<li>hard to build &#x26; maintain</li>
<li>hard to debug</li>
</ul>
<h6 id="the-value-of-patterns">The value of patterns</h6>
<ul>
<li>patterns can be seen as best-practices, that can be re-used, to suite particular needs, without the need to re-invent the wheel, by spending too much valuable time making mistakes</li>
<li>shared language</li>
<li>each pattern can be seen as component, that can be combined with others to solve problems</li>
</ul>
<h3 id="single-node-patterns">Single-Node Patterns</h3>
<h4 id="single-node">Single-Node</h4>
<p>Explanation: container - atomic part of DS, single machine - collection of one/several containers that can be viewed as one Node</p>
<h6 id="motivation">Motivation</h6>
<p>several containers per one machine have several benefits:</p>
<ul>
<li>cost reduction versus one container per machine</li>
<li>isolation of resources
<ul>
<li>each container can have limited resources of machine AND different priority to shared resources</li>
</ul>
</li>
<li>isolation of concerns - one container per one task
<ul>
<li>in such way, you can build small tools(ex: sync local data with GitRemote), that can be easily re-used</li>
<li>small services are easier to maintain, deploy, test etc</li>
</ul>
</li>
<li>team isolation - one container per one team</li>
</ul>
<p>such tight group of several containers per one machine may be known as <em>pod</em>(Kubernetes)</p>
<ul>
<li>each container must be able to access shared resources</li>
<li>deployment of all of containers must be easily done as single, atomic operation</li>
</ul>
<h4 id="sidecar">Sidecar</h4>
<p>Single-Node pattern, made-up from two containers: main(with application logic) AND side-car(extends possibilities of main container, without knowledge of it)</p>
<ul>
<li>deployed as single-node</li>
<li>side-car and main share resource heavily</li>
</ul>
<p>use-case:</p>
<ul>
<li>adoption of legacy code:
<ul>
<li>add HTTPs to legacy service by proxying traffic through side-car to main</li>
<li>add dynamic configuration to legacy service
<ul>
<li>remember that app config should be easily backed OR accessible via API, so app is aligned with 12-factors</li>
</ul>
</li>
</ul>
</li>
<li>re-usable utils:
<ul>
<li>easily add health-checking system, by deploying side-car, that can read info from machine/process AND establish common interface to access this data
<ul>
<li>alternative is to force each service to have such endpoint available</li>
</ul>
</li>
<li>problems: less tailored to specific needs, can be less performant</li>
<li>such “utils” can be used to build event-driven modular services, that can perform configurable set of actions, when event occurs(ex: code is pushed into Git)</li>
</ul>
</li>
</ul>
<p>good side-card must have:</p>
<ul>
<li>broad set of parameters
<ul>
<li>it is important for all containers, BUT it is especially important for side-car, to keep it highly-reusable</li>
</ul>
</li>
<li>API
<ul>
<li>ease of integration, ease of testing, lower risk of breaking-changes</li>
</ul>
</li>
<li>documentation
<ul>
<li>can be done inside Dockerfile(<code dir="auto">EXPOSE</code>, <code dir="auto">ENV</code>, <code dir="auto">LABEL</code>(metadata, there are established patterns to use them))</li>
</ul>
</li>
</ul>
<h4 id="ambassador">Ambassador</h4>
<p>Single-node pattern, with two tightly liked container: main(with main application logic), ambassador(communication middleware between main and external world)</p>
<ul>
<li>value comes from modularity and reusability</li>
</ul>
<p>use-cases:</p>
<ul>
<li>storage sharding - with grows, you need to shard your storage, because single machine won’t handle all file operations
<ul>
<li>problems: hard to integrate in system where other parts expect single interface to talk too, shards need to be managed, configuration is hard</li>
<li>often solved with ambassador as service, where shard manager is deployed onto single machine and act as load-balancer, BUT we can use ambassador as container and put it in front of each service directly
<ul>
<li>both approaches have tradeoff</li>
</ul>
</li>
</ul>
</li>
<li>service broker - common problem in DS is service discovery(properly connecting applications with each other), service, that solves this problem is called service broker
<ul>
<li>such service can be built with ambassador, basically your main connects to broker via localhost AND it is broker’s responsibility to find proper connection AND proxy requests to it</li>
</ul>
</li>
<li>blue/green, tee-ing AND other forms of request splitting for A/B testing purposes
<ul>
<li>tee-ing is practice of sending request to old AND new service to compare results, do load-testing etc</li>
<li>remember to keep your testing consistent per-user(keep some cache of who see what by IP)</li>
<li>note: as other things, this can be also done on app level OR on separate service level</li>
</ul>
</li>
</ul>
<p>why not create ambassador as a service(tho this is valid approach too):</p>
<ul>
<li>service need to be scaled independently</li>
<li>additional network latency</li>
</ul>
<h4 id="adapter">Adapter</h4>
<p>Single-node pattern, with two tightly linked containers: main(application logic), adapter(modification of main’s external interface to meet some needs)</p>
<ul>
<li>value comes from possibility to unify needed parts of application, without the need to alter original application, where each app can be implemented differently, across the organization</li>
</ul>
<p>use-cases:</p>
<ul>
<li>establish identical interface across DS
<ul>
<li>ex: health-checks, logs, performance monitoring</li>
</ul>
</li>
</ul>
<p>why not include adapter into main’s code:</p>
<ul>
<li>reusability &#x26; modularity, because adapter is decoupled from main</li>
<li>adapter helps protecting variations</li>
<li>main can use 3d-party apps to do the thing</li>
<li>BUT: if you can build your main with generic interface, you can, no need to create additional “custom” decision, that needs to be adapted</li>
</ul>
<h3 id="serving-patterns">Serving Patterns</h3>
<p>Serving patterns goes one level higher from Single-Node pattern, because now we are operating on Service level, where each Service is independent machine(Single-Node)</p>
<ul>
<li>each Service is loosely coupled with each other</li>
<li>communication is done only via network(some defined API) AND can be parallelized</li>
<li>Serving Pattern is based on Multi-Node systems, aka MicroServices</li>
<li>notes:
<ul>
<li>communication is always done via some API, BUT it can be: sync OR a-sync(stream based, queue based)</li>
</ul>
</li>
</ul>
<h4 id="replicated-load-balancer">Replicated Load-Balancer</h4>
<p>Comes from two parts:</p>
<ul>
<li>Stateless Service - service, that can operate with little-to-no internal state
<ul>
<li>pros: can be scaled horizontally AND don’t need state maintenance, makes system resilient</li>
<li>ex: API Gateway, CDN etc</li>
<li>notes:
<ul>
<li>to achieve resilience you always need to have AT LEAST 2 replicas, to have some time to do roll-outs and roll-backs + other can be scaled-up, if needed</li>
</ul>
</li>
</ul>
</li>
<li>Load-Balancer - service, that routes incoming requests to Services behind it
<ul>
<li>types:
<ul>
<li>StickySession
<ul>
<li>reasons: higher cache hits, requirement to maintain state between requests</li>
<li>problems: horizontal scale AND resilience are partially lost
<ul>
<li>to partially make-up for that, introduce consistent hashing</li>
</ul>
</li>
<li>notes:
<ul>
<li>can be done via IP or Cookies or Fingerprinting</li>
</ul>
</li>
</ul>
</li>
<li>Randomized - requests from same user can be routed to different machines
<ul>
<li>requests are distributed equally:
<ul>
<li>can be done statically OR with heal-checks, to determine if service keeps-up</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>notes:
<ul>
<li>each service need to have a notification mechanism, that it is up and running(readiness probe)</li>
<li>when doing Randomized type, you will have lower cache hit rate, BUT you can make-up for that, by moving cache from memory, to Cache as a Service, and going there first
<ul>
<li>you will have higher hit-rate, BUT slower operations, because of network overhead</li>
<li>basically, you always want a number of small application instances AND couple of large cache instance</li>
</ul>
</li>
<li>load-balancer can become API Gateway, with adding more functionality to it, like:
<ul>
<li>rate-limiting
<ul>
<li>as a pattern, you can give restricted access to anonymous users AND large limits to logged-in users</li>
<li>don’t forget to do proper <code dir="auto">429</code> response with header, that indicates when next request is allowed</li>
</ul>
</li>
<li>SSL certificate change
<ul>
<li>use-cases:
<ul>
<li>remove encryption on API Gateway and do internal communication via HTTP</li>
<li>remove public encryption AND add internal encryption to do internal communication
<ul>
<li>ideally each service must have uniq certificate</li>
<li>note: you can use custom certificates for internal usage AND specifically signed for public usage</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="sharded-service">Sharded Service</h4>
<p>Similar to replicated service, BUT each shard can process only subset of requests, thus more sophisticated Load Balancer required(in such context called Shard Manager) AND we can work with stateful services</p>
<ul>
<li>use-cases:
<ul>
<li>break large DB, FileStorage or Cache into smaller, more manageable once</li>
<li>break large game-server into several smaller once AND shard by player locations</li>
</ul>
</li>
</ul>
<h6 id="distributed-cache">Distributed Cache</h6>
<ul>
<li>why sharding - to increase processing capacity, without decreasing overall hit-rate</li>
<li>why cache is important:
<ul>
<li>increase in capacity of the system - cache can increase number of requests system can process, because you don’t need to count cache request as request processed by the system, but only by the cache
<ul>
<li>ex: 50% cache hit rate will double the amount of RPS your service can process, BUT putting max_limit as double is not ok, because failure in cache OR in shard of cache will lead to overload</li>
</ul>
</li>
<li>decrease in latency - cache will always be faster than actual calculations, so average response time is faster
<ul>
<li>remember, that depending solely on average value is dangerous, because if cache or it’s shard fails, requests can pile up in queues AND break the system</li>
<li>remember to load test with AND without cache</li>
</ul>
</li>
<li>notes:
<ul>
<li>when increasing number of shards, cache will degrade for a bit</li>
<li>replicating shards might be a good idea
<ul>
<li>this will allow for safe rollouts AND prevent “hot shards” problem, where some shard receives more load, because it’s content is popular at the moment</li>
<li>alternative is to design overall system resilient to cache failures, which is not always an option</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h6 id="sharding-function">Sharding Function</h6>
<ul>
<li>characteristics:
<ul>
<li>uniformal distribution</li>
<li>deterministic result</li>
</ul>
</li>
<li>choosing the identifier:
<ul>
<li>characteristics: stable</li>
<li>examples: request path, entity ID, geographical location</li>
<li>notes:
<ul>
<li>if several IDs used in to find shard, you need to find their hashes separately AND by both hashes find shard, not calculate combined hash</li>
</ul>
</li>
</ul>
</li>
<li>implementations:
<ul>
<li>hashing function
<ul>
<li>algorithm: transform some identifier in request to integer hash -> modulo hash value by number of shard -> route request there</li>
<li>problem lies, when re-sharding needed, because this will produce to large number of request remapping AND will lead to partial/full cache failure</li>
</ul>
</li>
<li>consistent hashing - solves re-sharding problem</li>
</ul>
</li>
</ul>
<h4 id="scattergather">Scatter/Gather</h4>
<p>Pattern, that enables processing of requests in parallel, by breaking request into small, independent once, processing each part in parallel and combining into whole answer again</p>
<ul>
<li>you can view it as sharding of computation resources, rather then data sharding</li>
<li>Root can also dynamically measure how each Shard responding AND load it more/less</li>
<li>similar situation can happen, if you have initial large data-set, that need to be calculated-upon on demand, BUT is impossible to hold in one machine
<ul>
<li>basically, Root will route request to each Shard, each Shard can process only part of data-set(no risk of duplication), Root aggregates responses into large Response</li>
</ul>
</li>
<li>note:
<ul>
<li>MapReduce is great algorithm for some Scatter/Gather use-cases</li>
<li>when it comes to scaling number of Shards, remember about bottlenecks like: network, processing resources of Root, struggler problem(final time will equal to speed of slowest Shard OR if one Shard fails, request fails)</li>
<li>to make system more resilient, replicate each shard</li>
</ul>
</li>
</ul>
<h4 id="event-driven-processing">Event-Driven Processing</h4>
<p>FAAS (function as a service) is popular name for Even-Driven Processing pattern, which basically is an alternative to long-running servers, that have state, can perform long-running computations etc</p>
<ul>
<li>basically, FASS is short-lived service, that is triggered by event, spins-up, do some work and spins-down
<ul>
<li>note, that serverless is kinda similar to FASS, because serverless is about operation without personal server, so FASS can be executed with such model in mind, BUT FASS can also execute on your machine</li>
</ul>
</li>
<li>please, don’t use it as one fits all solution ;)</li>
<li>BENEFITS // DX, auto-scaling, auto-recovery, high modularity(FASS is even more atomic then container)</li>
<li>PROBLEMS // hard to debug, no local state/cache, network overhead, self-DDOS, won’t work with long running OR background processes
<ul>
<li>always remember to include monitoring in such highly-modular system</li>
<li>it is costly, so, on scale, it is better to just use classical server OR self-host open-source FASS solutions</li>
</ul>
</li>
<li>patterns:
<ul>
<li>Decorator - take request, transform, pass along</li>
</ul>
</li>
<li>use-cases: handling async-events</li>
</ul>
<h4 id="ownership-election">Ownership Election</h4>
<p>Ownership in Single-Node system is easy, there is one node, that owns somethings, BUT for scalability we need replication, thus a way to establish ownership</p>
<ul>
<li>generally we operate with Master and Slave naming, where replica cluster has single Master, that is a main owner AND other replicas are Slaves, that can be elected as Master by some election protocol</li>
<li>side-note: ownership election is only needed, for distributed systems with replication mechanisms
<ul>
<li>remember that such systems have pros and cons, so it is important to decide is it worth the money, maintenance issues etc</li>
</ul>
</li>
</ul>
<h6 id="sharing-resources">Sharing resources</h6>
<p>One approach to build distributed system, is not even elect Master, it is to share resources, which is done by locking mechanisms: Mutex, Semaphore</p>
<ul>
<li>note, locks are usually used inside service and implemented with some primitives, that manipulate shared variable, BUT locks for distributed systems are done as shared key-value store</li>
<li>in distributed system process might file AND not release the lock, so some TTL timestamp is needed, that will perform release after expiration
<ul>
<li>add some mechanism, that won’t allow replica to unlock the lock after TTL expired OR crash the service after TTL, if it is appropriate</li>
</ul>
</li>
<li>if needed, we can add renew mechanism, that will allow holder to renew TTL value and continue holding the lock
<ul>
<li>mainly used, when ownership is needed for whole duration of service life</li>
<li>such long-running locks MAY resolve in concurrent behavior, where timeouted holder, for short period of time, beliefs that he is still holding, SO we need to store hostname of actual holder AND add validity checks, that will be performed by workers, who receive requests from replicas</li>
</ul>
</li>
<li>due to network, it is possible that order of requests can be mixed in such way, that lock won’t prevent it, to mitigate you need to add version to request itself AND add validity check to worker</li>
</ul>
<h3 id="batch-computational-patterns">Batch Computational Patterns</h3>
<p>There are cases, when you need to process large amount of data in short-period of time, so patterns for that arrived</p>
<ul>
<li>mainly speed is achieved via parallelism</li>
<li>ex: video processing, data aggregation, report generation etc</li>
</ul>
<h4 id="work-queue">Work Queue</h4>
<p>Main idea of WorkQueue is to have independent tasks, that need to be executed within some time-period</p>
<ul>
<li>such tasks are placed on queue, grabbed by Manager and passed to workers
<ul>
<li>workers can be scaled-up/down on demand to meet expectations</li>
</ul>
</li>
<li>note that we can extract generic queue logic from application specific part via ambassador pattern, so we can plug use-case specific ambassadors, when needed
<ul>
<li>general fact, when establishing API between those to, always add version for future-proofing</li>
</ul>
</li>
<li>when engineering Worker it is best to work with file-api, because you can generalize process of downloading and passing file to some black-box(script) AND then sending outputted result back to the cloud</li>
<li>general algorithm: load available work -> determine state of each item -> spawn workers to process unprocessed items -> mark item as processed on finish</li>
<li>autoscaling must rely on average time to process item AND average time when new item arrives
<ul>
<li>in order for system to keep-up you need to process faster, that things arrive
<ul>
<li>processing faster, makes it possible to deal with bursts of traffic</li>
</ul>
</li>
</ul>
</li>
<li>if you need to stack operations(ex: detect object, blur object), it is better to create Worker Aggregator, that will implement single Worker interface, BUT under the hood delegate to two workers</li>
</ul>
<h4 id="event-driven-batch-processing">Event-Driven Batch Processing</h4>
<p>Event-Driven Batch Processing aka Workflow is basically stands for multiple Work Queues, that pass result of one Queue as input for another</p>
<ul>
<li>in it’s simplest form, triggering Event is end of one process and data passing to other one, BUT it can be more complicated
<ul>
<li>ex: you need to wait for two queues to output, so results are merged simultaneously in the next Queue</li>
</ul>
</li>
<li>it is something similar to event-driven FAAS</li>
</ul>
<p>pattern:</p>
<ul>
<li>copier - duplicate single input into same output, but multiplied</li>
<li>filter - filter-out Batches, that don’t meet some criteria
<ul>
<li>it can be as simple as putting Ambassador onto generic queue</li>
</ul>
</li>
<li>splitter - split evenly OR by some criteria single input into multiple outputs</li>
<li>merge - combine several input flows into one flow</li>
</ul>
<p>we can hand-craft some event system, BUT it is better to use pattern of publisher-subscriber, where we have some Publisher, that adds Messages to Queue AND Subscriber, that listens for new Messages in queues, grabs and processes them</p>
<h4 id="coordinated-batch-processing">Coordinated Batch-Processing</h4>
<p>Coordination is basically a continuation of Event-Driven Batch Processing topic with focus on how to actually aggregate/merge several parallel results</p>
<p>patterns:</p>
<ul>
<li>join - wait for AND combine set of inputs into single output
<ul>
<li>remember, that it will reduce parallelism AND make things slower</li>
</ul>
</li>
<li>reduce - similar to join, BUT here we performing some operation, as well as joining, that will reduce data set to some other data
<ul>
<li>reduces can be chained, so we still have reduced parallelism, BUT not as much as join</li>
</ul>
</li>
</ul> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/it_docs/all/software_engineering_at_google-oreilly/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Notes of &quot;Software Engineering at Google&quot; by O&#39;Reilly</span> </span> </a> <a href="/it_docs/all/testing/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Testing</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>